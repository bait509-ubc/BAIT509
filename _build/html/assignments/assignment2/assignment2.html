
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>BAIT 509 Assignment 2: Preprocessing, Pipelines and Hyperparameter Tuning &#8212; BAIT 509 - Business Applications of Machine Learning</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://bait509-ubc.github.io/BAIT509/intro.html/assignments/assignment2/assignment2.html" />
    <link rel="shortcut icon" href="../../_static/bait_logo.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/bait_logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">BAIT 509 - Business Applications of Machine Learning</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p class="caption" role="heading">
 <span class="caption-text">
  Things You Should Know
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../things_to_know/who.html">
   Who: Hayley Boyce
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../things_to_know/how.html">
   How: The Course Structure
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../things_to_know/what.html">
   What: Learning Outcomes
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  Lectures
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../lectures/lecture1.html">
   1. Intro to ML &amp;  Decision Trees
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../lectures/lecture2.html">
   2. Splitting and Cross-validation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../lectures/lecture3.html">
   3. Baseline, k-Nearest Neighbours
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../lectures/lecture4.html">
   4. SVM with RBF Kernel and Feature Preprocessing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../lectures/lecture5.html">
   5. Preprocessing Categorical Features and Column Transformer
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../lectures/lecture6.html">
   6. Naive Bayes and Hyperparameter Optimization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../lectures/lecture7.html">
   7. Linear Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../lectures/lecture8.html">
   8. Business Objectives/Statistical Questions and Feature Selection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../lectures/lecture9.html">
   9. Classification and Regression Metrics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../lectures/lecture10.html">
   10. Multi-Class, Pandas Profiling, Finale
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  References
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../things_to_know/attribution.html">
   Attribution
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/assignments/assignment2/assignment2.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/bait509-ubc/BAIT509"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/bait509-ubc/BAIT509/issues/new?title=Issue%20on%20page%20%2Fassignments/assignment2/assignment2.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/bait509-ubc/BAIT509/edit/master/assignments/assignment2/assignment2.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/bait509-ubc/BAIT509/master?urlpath=tree/assignments/assignment2/assignment2.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   BAIT 509 Assignment 2: Preprocessing, Pipelines and Hyperparameter Tuning
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tidy-submission">
     Tidy Submission
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#answering-questions">
     Answering Questions
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#introduction-and-learning-goals-a-name-in-a">
     Introduction and learning goals
     <a name="in">
     </a>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#introduction-a-name-in-a">
     Introduction
     <a name="in">
     </a>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-1-introducing-and-exploring-the-dataset-a-name-1-a">
     Exercise 1: Introducing and Exploring the dataset
     <a name="1">
     </a>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#data-splitting">
       1.1 Data splitting
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#numeric-vs-categorical-features">
       1.2 Numeric vs. categorical features
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#describing-your-data">
       1.3 Describing your data
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#visualizing-features">
       1.4 Visualizing features
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#explaining-the-visualizations">
       1.5 Explaining the Visualizations
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#separating-feature-vectors-and-targets">
       1.6 Separating feature vectors and targets
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#training">
       1.7 Training?
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-2-preprocessing-a-name-3-a">
     Exercise 2: Preprocessing
     <a name="3">
     </a>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#identifying-transformations-that-need-to-be-applied">
       2.1 Identifying transformations that need to be applied
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#numeric-feature-pipeline">
       2.2 Numeric feature pipeline
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#categorical-feature-pipeline">
       2.3 Categorical feature pipeline
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#columntransformer">
       2.4 ColumnTransformer
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-3-building-a-model-a-name-4-a">
     Exercise 3: Building a Model
     <a name="4">
     </a>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dummy-classifier">
       3.1 Dummy Classifier
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#main-pipeline">
       3.2 Main pipeline
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#hyperparameter-tuning">
       3.3 Hyperparameter tuning
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#choosing-your-hyperparameters">
       3.4 Choosing your hyperparameters
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#evaluating-on-the-test-set-a-name-5-a">
   4. Evaluating on the test set
   <a name="5">
   </a>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#scoring-your-final-model">
     4.1 Scoring your final model
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#assessing-your-model">
     4.2 Assessing your model
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#submission-to-canvas">
     Submission to Canvas
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#congratulations-on-finishing-assignment-2-now-you-are-ready-to-build-a-simple-ml-pipeline-on-real-world-datasets">
     Congratulations on finishing Assignment 2! Now you are ready to build a simple ML pipeline on real-world datasets!
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="bait-509-assignment-2-preprocessing-pipelines-and-hyperparameter-tuning">
<h1>BAIT 509 Assignment 2: Preprocessing, Pipelines and Hyperparameter Tuning<a class="headerlink" href="#bait-509-assignment-2-preprocessing-pipelines-and-hyperparameter-tuning" title="Permalink to this headline">¶</a></h1>
<p><strong>Evaluates</strong>: Lectures 4 - 6.</p>
<p><strong>Rubrics</strong>: Your solutions will be assessed primarily on the accuracy of your coding, as well as the clarity and correctness of your written responses. The MDS rubrics provide a good guide as to what is expected of you in your responses to the assignment questions and how the TAs will grade your answers. See the following links for more details:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/UBC-MDS/public/blob/master/rubric/rubric_mech.md">mechanics_rubric</a>: submit an assignment correctly.</p></li>
<li><p><a class="reference external" href="https://github.com/UBC-MDS/public/blob/master/rubric/rubric_accuracy.md">accuracy rubric</a>: evaluating your code.</p></li>
<li><p><a class="reference external" href="https://github.com/UBC-MDS/public/blob/master/rubric/rubric_autograde.md">autograde rubric</a>: evaluating questions that are either right or wrong.</p></li>
<li><p><a class="reference external" href="https://github.com/UBC-MDS/public/blob/master/rubric/rubric_reasoning.md">reasoning rubric</a>: evaluating your written responses.</p></li>
</ul>
<div class="section" id="tidy-submission">
<h2>Tidy Submission<a class="headerlink" href="#tidy-submission" title="Permalink to this headline">¶</a></h2>
<p>rubric={mechanics:2}</p>
<ul class="simple">
<li><p>Complete this assignment by filling out this jupyter notebook.</p></li>
<li><p>You must use proper English, spelling, and grammar.</p></li>
<li><p>You will submit two things to Canvas:</p>
<ol class="simple">
<li><p>This jupyter notebook file containing your responses ( an <code class="docutils literal notranslate"><span class="pre">.ipynb</span></code> file); and,</p></li>
<li><p>An <code class="docutils literal notranslate"><span class="pre">.html</span></code> file of your completed notebook (use <code class="docutils literal notranslate"><span class="pre">jupyter</span> <span class="pre">nbconvert</span> <span class="pre">--to</span> <span class="pre">html_embed</span> <span class="pre">assignment.ipynb</span></code> in the terminal to generate the html file or under <code class="docutils literal notranslate"><span class="pre">File</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">Export</span> <span class="pre">Notebook</span> <span class="pre">As</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">HTML</span></code>).</p></li>
</ol>
</li>
</ul>
 <br>  
<p>Submit your assignment through <a class="reference external" href="https://canvas.ubc.ca/courses/58082">UBC Canvas</a> by <strong>11:59 pm Monday, May 10th</strong>.</p>
</div>
<div class="section" id="answering-questions">
<h2>Answering Questions<a class="headerlink" href="#answering-questions" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Places that you see <code class="docutils literal notranslate"><span class="pre">raise</span> <span class="pre">NotImplementedError</span> <span class="pre">#</span> <span class="pre">No</span> <span class="pre">Answer</span> <span class="pre">-</span> <span class="pre">remove</span> <span class="pre">if</span> <span class="pre">you</span> <span class="pre">provide</span> <span class="pre">an</span> <span class="pre">answer</span></code>. Substitute the <code class="docutils literal notranslate"><span class="pre">None</span></code> above it and replace the <code class="docutils literal notranslate"><span class="pre">raise</span> <span class="pre">NotImplementedError</span> <span class="pre">#</span> <span class="pre">No</span> <span class="pre">Answer</span> <span class="pre">-</span> <span class="pre">remove</span> <span class="pre">if</span> <span class="pre">you</span> <span class="pre">provide</span> <span class="pre">an</span> <span class="pre">answer</span></code> with your completed code and answers, then proceed to run the cell!</p></li>
<li><p>Any place you see <code class="docutils literal notranslate"><span class="pre">____</span></code>, you must fill in the function, variable, or data to complete the code.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import libraries</span>
<span class="kn">from</span> <span class="nn">hashlib</span> <span class="kn">import</span> <span class="n">sha1</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>
<span class="n">alt</span><span class="o">.</span><span class="n">data_transformers</span><span class="o">.</span><span class="n">disable_max_rows</span><span class="p">()</span>

<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.max_colwidth&quot;</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>


<span class="kn">from</span> <span class="nn">sklearn.dummy</span> <span class="kn">import</span> <span class="n">DummyClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <span class="n">SimpleImputer</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span><span class="p">,</span> <span class="n">cross_validate</span><span class="p">,</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span><span class="p">,</span> <span class="n">make_pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.compose</span> <span class="kn">import</span> <span class="n">ColumnTransformer</span><span class="p">,</span> <span class="n">make_column_transformer</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span><span class="p">,</span> <span class="n">RandomizedSearchCV</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">OneHotEncoder</span><span class="p">,</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span>

<span class="kn">import</span> <span class="nn">test_assignment2</span> <span class="k">as</span> <span class="nn">t</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="introduction-and-learning-goals-a-name-in-a">
<h2>Introduction and learning goals <a name="in"></a><a class="headerlink" href="#introduction-and-learning-goals-a-name-in-a" title="Permalink to this headline">¶</a></h2>
<hr>
<p>Welcome to the assignment! After working on this assignment, you should be able to:</p>
<ul class="simple">
<li><p>Identify when to implement feature transformations such as imputation and scaling.</p></li>
<li><p>Apply <code class="docutils literal notranslate"><span class="pre">sklearn.pipeline.Pipeline</span></code> to build a machine learning pipeline.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">sklearn</span></code> for applying numerical feature transformations on the data.</p></li>
<li><p>Identify when it’s appropriate to apply ordinal encoding vs one-hot encoding.</p></li>
<li><p>Explain strategies to deal with categorical variables with too many categories.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">ColumnTransformer</span></code> to build all our transformations together into one object and use it with <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code> pipelines.</p></li>
<li><p>Carry out hyperparameter optimization using <code class="docutils literal notranslate"><span class="pre">sklearn</span></code>’s <code class="docutils literal notranslate"><span class="pre">GridSearchCV</span></code> and <code class="docutils literal notranslate"><span class="pre">RandomizedSearchCV</span></code>.</p></li>
</ul>
</div>
<div class="section" id="introduction-a-name-in-a">
<h2>Introduction <a name="in"></a><a class="headerlink" href="#introduction-a-name-in-a" title="Permalink to this headline">¶</a></h2>
<hr>
<p>A crucial step when using machine learning algorithms on real-world datasets is preprocessing. This assignment will give you some practice to build a preliminary supervised machine learning pipeline on a real-world dataset.</p>
</div>
<div class="section" id="exercise-1-introducing-and-exploring-the-dataset-a-name-1-a">
<h2>Exercise 1: Introducing and Exploring the dataset <a name="1"></a><a class="headerlink" href="#exercise-1-introducing-and-exploring-the-dataset-a-name-1-a" title="Permalink to this headline">¶</a></h2>
<hr>
<p>In this assignment, you will be working on a sample of <a class="reference external" href="https://www.kaggle.com/uciml/adult-census-income">the adult census dataset</a>. We have made some modifications to this data so that it’s easier to work with.</p>
<p>This is a classification dataset and the classification task is to predict whether income exceeds 50K per year or not based on the census data. You can find more information on the dataset and features <a class="reference external" href="http://archive.ics.uci.edu/ml/datasets/Adult">here</a>.</p>
<p><em>Note that many popular datasets have sex as a feature where the possible values are male and female. This representation reflects how the data were collected and is not meant to imply that, for example, gender is binary.</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### BEGIN STARTER CODE</span>
<span class="n">census_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;adult.csv&quot;</span><span class="p">)</span>
<span class="n">census_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="c1">### END STARTER CODE</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="data-splitting">
<h3>1.1 Data splitting<a class="headerlink" href="#data-splitting" title="Permalink to this headline">¶</a></h3>
<p>rubric={accuracy:2}</p>
<p>To avoid violation of the golden rule, the first step before we do anything is splitting the data.</p>
<p>Split the data into <code class="docutils literal notranslate"><span class="pre">train_df</span></code> (80%) and <code class="docutils literal notranslate"><span class="pre">test_df</span></code> (20%). Keep the target column (<code class="docutils literal notranslate"><span class="pre">income</span></code>) in the splits so that we can use it in EDA.</p>
<p>To pass the test, please use <code class="docutils literal notranslate"><span class="pre">random_state=42</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># your code here</span>
<span class="k">raise</span> <span class="ne">NotImplementedError</span> <span class="c1"># No Answer - remove if you provide an answer</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">.</span><span class="n">test_1_1</span><span class="p">(</span><span class="n">train_df</span><span class="p">,</span><span class="n">test_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s examine our <code class="docutils literal notranslate"><span class="pre">train_df</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### BEGIN STARTER CODE</span>

<span class="n">train_df</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="c1">### END STARTER CODE</span>
</pre></div>
</div>
</div>
</div>
<p>We see some missing values represented with a “?”. Probably these were the questions not answered by some people during the census.  Usually <code class="docutils literal notranslate"><span class="pre">.describe()</span></code> or <code class="docutils literal notranslate"><span class="pre">.info()</span></code> methods would give you information on missing values. But here, they won’t pick “?” as missing values as they are encoded as strings instead of an actual NaN in Python. So let’s replace them with <code class="docutils literal notranslate"><span class="pre">np.NaN</span></code> before we carry out EDA. If you do not do it, you’ll encounter an error later on when you try to pass this data to a classifier.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### BEGIN STARTER CODE</span>

<span class="n">train_df_nan</span> <span class="o">=</span> <span class="n">train_df</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;?&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">NaN</span><span class="p">)</span>
<span class="n">test_df_nan</span> <span class="o">=</span> <span class="n">test_df</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;?&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">NaN</span><span class="p">)</span>
<span class="n">train_df_nan</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="c1">### END STARTER CODE</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="numeric-vs-categorical-features">
<h3>1.2 Numeric vs. categorical features<a class="headerlink" href="#numeric-vs-categorical-features" title="Permalink to this headline">¶</a></h3>
<p>rubric={reasoning:2}</p>
<p>Identify numeric and categorical features and create lists for each of them.</p>
<p>We’ve started this by adding a column label for each feature type.</p>
<p><em>Save the column names as string elements in each of the corresponding lists below</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">numeric_features</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;age&quot;</span><span class="p">,</span> <span class="p">]</span>
<span class="n">categorical_features</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;workclass&quot;</span><span class="p">,</span> <span class="p">]</span>


<span class="c1"># your code here</span>
<span class="k">raise</span> <span class="ne">NotImplementedError</span> <span class="c1"># No Answer - remove if you provide an answer</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">.</span><span class="n">test_1_2_1</span><span class="p">(</span><span class="n">numeric_features</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">.</span><span class="n">test_1_2_2</span><span class="p">(</span><span class="n">categorical_features</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="describing-your-data">
<h3>1.3 Describing your data<a class="headerlink" href="#describing-your-data" title="Permalink to this headline">¶</a></h3>
<p>rubric={accuracy:2}</p>
<p>Use <code class="docutils literal notranslate"><span class="pre">.describe()</span></code> to show summary statistics of each feature in the <code class="docutils literal notranslate"><span class="pre">train_df_nan</span></code> dataframe. It’s important to call the argument <code class="docutils literal notranslate"><span class="pre">include=&quot;all&quot;</span></code> to get statistics of <em><strong>all</strong></em> the columns.</p>
<p><em>Save this in an object named <code class="docutils literal notranslate"><span class="pre">train_stats</span></code>.</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_stats</span> <span class="o">=</span> <span class="kc">None</span>

<span class="c1"># your code here</span>
<span class="k">raise</span> <span class="ne">NotImplementedError</span> <span class="c1"># No Answer - remove if you provide an answer</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">.</span><span class="n">test_1_3</span><span class="p">(</span><span class="n">train_stats</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="visualizing-features">
<h3>1.4 Visualizing features<a class="headerlink" href="#visualizing-features" title="Permalink to this headline">¶</a></h3>
<p>rubric={viz:1}</p>
<p>We have provided you with some code that will visualize the distributions of the <strong>numeric features</strong> in our data, plotted as histograms.</p>
<p>Fill in the code where you see <code class="docutils literal notranslate"><span class="pre">___</span></code> below so that it produces the graphs.</p>
<p><em>This may take 10 seconds to run.</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># def plot_histogram(df,feature):</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     plots a histogram of the distribution of features</span>

<span class="c1">#     Parameters</span>
<span class="c1">#     ----------</span>
<span class="c1">#     feature: str</span>
<span class="c1">#         the feature name</span>
<span class="c1">#     Returns</span>
<span class="c1">#     -------</span>
<span class="c1">#     altair.vegalite.v3.api.Chart</span>
<span class="c1">#         an Altair histogram </span>
<span class="c1">#     &quot;&quot;&quot;</span>


<span class="c1">#    ## Creates a visualization named histogram that plots the feature on the x-axis</span>
<span class="c1">#    ##  and the frequency/count on the y-axis and colouring by the income column</span>
<span class="c1">#     histogram = alt.Chart(df).mark_bar(</span>
<span class="c1">#         opacity=0.7).encode(</span>
<span class="c1">#         alt.X(str(feature) + str(&#39;:O&#39;), bin=alt.Bin(maxbins=50)),</span>
<span class="c1">#         alt.Y(&#39;count()&#39;, stack=None),</span>
<span class="c1">#         alt.Color(&#39;income:N&#39;)).properties(</span>
<span class="c1">#         title= (&#39;Feature:&#39; + feature))</span>
<span class="c1">#     return histogram</span>


<span class="c1"># ## This is where we call our function on our training feature table and create a plot </span>
<span class="c1"># ## for each numeric feature in it. </span>

<span class="c1"># figure_dict = dict()</span>
<span class="c1"># for feature in ___:</span>
<span class="c1">#     train_df_nan = train_df_nan.sort_values(&#39;income&#39;)</span>
<span class="c1">#     figure_dict.update({feature:plot_histogram(___,feature)})</span>
<span class="c1"># figure_panel = alt.vconcat(*figure_dict.values())</span>
<span class="c1"># figure_panel</span>


<span class="c1"># your code here</span>
<span class="k">raise</span> <span class="ne">NotImplementedError</span> <span class="c1"># No Answer - remove if you provide an answer</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="explaining-the-visualizations">
<h3>1.5 Explaining the Visualizations<a class="headerlink" href="#explaining-the-visualizations" title="Permalink to this headline">¶</a></h3>
<p>rubric={reasoning:2}</p>
<p>Based on the above visualizations, which features seem relevant for the given prediction task?</p>
<p>YOUR ANSWER HERE</p>
</div>
<div class="section" id="separating-feature-vectors-and-targets">
<h3>1.6 Separating feature vectors and targets<a class="headerlink" href="#separating-feature-vectors-and-targets" title="Permalink to this headline">¶</a></h3>
<p>rubric={accuracy:2}</p>
<p>Create <code class="docutils literal notranslate"><span class="pre">X_train</span></code>, <code class="docutils literal notranslate"><span class="pre">y_train</span></code>, <code class="docutils literal notranslate"><span class="pre">X_test</span></code>, <code class="docutils literal notranslate"><span class="pre">y_test</span></code> from <code class="docutils literal notranslate"><span class="pre">train_df_nan</span></code> and <code class="docutils literal notranslate"><span class="pre">test_df_nan</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="kc">None</span>

<span class="c1"># your code here</span>
<span class="k">raise</span> <span class="ne">NotImplementedError</span> <span class="c1"># No Answer - remove if you provide an answer</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">.</span><span class="n">test_1_6</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">X_test</span><span class="p">,</span><span class="n">y_train</span><span class="p">,</span><span class="n">y_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="training">
<h3>1.7 Training?<a class="headerlink" href="#training" title="Permalink to this headline">¶</a></h3>
<p>rubric={reasoning:2}</p>
<p>If you train <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.svm.SVC.html"><code class="docutils literal notranslate"><span class="pre">sklearn</span></code>’s <code class="docutils literal notranslate"><span class="pre">SVC</span></code></a> model on <code class="docutils literal notranslate"><span class="pre">X_train</span></code> and <code class="docutils literal notranslate"><span class="pre">y_train</span></code> at this point, would it work? Why or why not?</p>
<p>YOUR ANSWER HERE</p>
</div>
</div>
<div class="section" id="exercise-2-preprocessing-a-name-3-a">
<h2>Exercise 2: Preprocessing <a name="3"></a><a class="headerlink" href="#exercise-2-preprocessing-a-name-3-a" title="Permalink to this headline">¶</a></h2>
<hr><p>In this exercise, you’ll be wrangling the dataset so that it’s suitable to be used with <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code> classifiers.</p>
<div class="section" id="identifying-transformations-that-need-to-be-applied">
<h3>2.1 Identifying transformations that need to be applied<a class="headerlink" href="#identifying-transformations-that-need-to-be-applied" title="Permalink to this headline">¶</a></h3>
<p>rubric={reasoning:7}</p>
<p>Identify the columns on which transformations need to be applied and tell us what transformation you would apply in what order by filling in the table below. Example transformations are shown for the feature <code class="docutils literal notranslate"><span class="pre">age</span></code> in the table.</p>
<p>Note that for this problem, no ordinal encoding will be executed on this dataset.</p>
<p>Are there any columns that you think should be dropped from the features? If so, explain your answer.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Feature</p></th>
<th class="head"><p>Transformation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>age</p></td>
<td><p>imputation, scaling</p></td>
</tr>
<tr class="row-odd"><td><p>workclass</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>fnlwgt</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>education</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>education_num</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>marital_status</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>occupation</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>relationship</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>race</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>sex</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>capital_gain</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>capital_loss</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>hours_per_week</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>native_country</p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<p>YOUR ANSWER HERE</p>
</div>
<div class="section" id="numeric-feature-pipeline">
<h3>2.2 Numeric feature pipeline<a class="headerlink" href="#numeric-feature-pipeline" title="Permalink to this headline">¶</a></h3>
<p>rubric={accuracy:2}</p>
<p>Let’s start making our pipelines. Use <code class="docutils literal notranslate"><span class="pre">make_pipeline()</span></code> or <code class="docutils literal notranslate"><span class="pre">Pipeline()</span></code> to make a pipeline for the numeric features called <code class="docutils literal notranslate"><span class="pre">numeric_transformer</span></code>.</p>
<p>Use <code class="docutils literal notranslate"><span class="pre">SimpleImputation()</span></code> with <code class="docutils literal notranslate"><span class="pre">strategy='median'</span></code>. For the second step make sure to use standardization with <code class="docutils literal notranslate"><span class="pre">StandardScaler()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">numeric_transformer</span> <span class="o">=</span> <span class="kc">None</span>

<span class="c1"># your code here</span>
<span class="k">raise</span> <span class="ne">NotImplementedError</span> <span class="c1"># No Answer - remove if you provide an answer</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">.</span><span class="n">test_2_2</span><span class="p">(</span><span class="n">numeric_transformer</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="categorical-feature-pipeline">
<h3>2.3 Categorical feature pipeline<a class="headerlink" href="#categorical-feature-pipeline" title="Permalink to this headline">¶</a></h3>
<p>rubric={accuracy:2}</p>
<p>Next, make a pipeline for the categorical features called <code class="docutils literal notranslate"><span class="pre">categorical_transformer</span></code>.</p>
<p>Use <code class="docutils literal notranslate"><span class="pre">SimpleImputation()</span></code> with <code class="docutils literal notranslate"><span class="pre">strategy='most_frequent'</span></code>.</p>
<p>Make sure to use the necessary one-hot encoding transformer with <code class="docutils literal notranslate"><span class="pre">dtype=int</span></code> and <code class="docutils literal notranslate"><span class="pre">handle_unknown=&quot;ignore&quot;</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">categorical_transformer</span> <span class="o">=</span> <span class="kc">None</span>

<span class="c1"># your code here</span>
<span class="k">raise</span> <span class="ne">NotImplementedError</span> <span class="c1"># No Answer - remove if you provide an answer</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">.</span><span class="n">test_2_3</span><span class="p">(</span><span class="n">categorical_transformer</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="columntransformer">
<h3>2.4 ColumnTransformer<a class="headerlink" href="#columntransformer" title="Permalink to this headline">¶</a></h3>
<p>rubric={accuracy:2}</p>
<p>Below we have defined a column transformer using <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.compose.ColumnTransformer.html?highlight=columntransformer#sklearn.compose.ColumnTransformer"><code class="docutils literal notranslate"><span class="pre">ColumnTransformer</span></code></a> called <code class="docutils literal notranslate"><span class="pre">preprocessor</span></code> for the numerical, categorical, binary and dropped features.</p>
<p>Fill in the blank (<code class="docutils literal notranslate"><span class="pre">___</span></code>) so that the code executes and a ColumnTransformer transforms the appropriate feature with their transformations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># preprocessor = ColumnTransformer(</span>
<span class="c1">#     ___=[(&quot;numeric&quot;, ___, numeric_features),</span>
<span class="c1">#          (&quot;categorical&quot;, ___, ___)           </span>
<span class="c1">#                  ], </span>
<span class="c1">#     remainder=&#39;drop&#39;    </span>
<span class="c1"># )</span>

<span class="c1"># your code here</span>
<span class="k">raise</span> <span class="ne">NotImplementedError</span> <span class="c1"># No Answer - remove if you provide an answer</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">.</span><span class="n">test_2_4</span><span class="p">(</span><span class="n">preprocessor</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="exercise-3-building-a-model-a-name-4-a">
<h2>Exercise 3: Building a Model <a name="4"></a><a class="headerlink" href="#exercise-3-building-a-model-a-name-4-a" title="Permalink to this headline">¶</a></h2>
<hr>
<p>Now that we have preprocessed features, we are ready to build models.</p>
<div class="section" id="dummy-classifier">
<h3>3.1 Dummy Classifier<a class="headerlink" href="#dummy-classifier" title="Permalink to this headline">¶</a></h3>
<p>rubric={accuracy:3}</p>
<p>It’s important to build a dummy classifier to compare our model to. Make a <code class="docutils literal notranslate"><span class="pre">DummyClassifier</span></code> and make sure to train it and then score it on the training and test sets.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># your code here</span>
<span class="k">raise</span> <span class="ne">NotImplementedError</span> <span class="c1"># No Answer - remove if you provide an answer</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="main-pipeline">
<h3>3.2 Main pipeline<a class="headerlink" href="#main-pipeline" title="Permalink to this headline">¶</a></h3>
<p>rubric={accuracy:2}</p>
<p>Define a main pipeline that transforms all the different features and uses an <code class="docutils literal notranslate"><span class="pre">SVC</span></code> model with default hyperparameters.</p>
<p>If you are using <code class="docutils literal notranslate"><span class="pre">Pipeline</span></code> instead of <code class="docutils literal notranslate"><span class="pre">make_pipeline</span></code>, name each of your steps <code class="docutils literal notranslate"><span class="pre">columntransformer</span></code> and <code class="docutils literal notranslate"><span class="pre">svc</span></code> respectively.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">main_pipe</span> <span class="o">=</span> <span class="kc">None</span>

<span class="c1"># your code here</span>
<span class="k">raise</span> <span class="ne">NotImplementedError</span> <span class="c1"># No Answer - remove if you provide an answer</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="hyperparameter-tuning">
<h3>3.3 Hyperparameter tuning<a class="headerlink" href="#hyperparameter-tuning" title="Permalink to this headline">¶</a></h3>
<p>rubric={accuracy:3}</p>
<p>Now that we have our pipelines and a model, let’s tune the hyperparameters <code class="docutils literal notranslate"><span class="pre">gamma</span></code> and <code class="docutils literal notranslate"><span class="pre">C</span></code>.</p>
<p>Sweep over the hyperparameters in <code class="docutils literal notranslate"><span class="pre">param_grid</span></code> using <code class="docutils literal notranslate"><span class="pre">RandomizedSearchCV</span></code> with a  <code class="docutils literal notranslate"><span class="pre">cv=5</span></code>, <code class="docutils literal notranslate"><span class="pre">n_iter=10</span></code> and setting <code class="docutils literal notranslate"><span class="pre">return_train_score=True</span></code> naming the object <code class="docutils literal notranslate"><span class="pre">random_search</span></code>. It also may be a good idea to set <code class="docutils literal notranslate"><span class="pre">random_state</span></code> here. Setting <code class="docutils literal notranslate"><span class="pre">verbose=3</span></code> will also give you information as the search is occurring.</p>
<p>You will need to fit your <code class="docutils literal notranslate"><span class="pre">RandomizedSearchCV</span></code> object.</p>
<p>This step is quite demanding computationally so be prepared for this to take 2 or 3 minutes and your fan may start to run!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;svc__gamma&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
    <span class="s2">&quot;svc__C&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
<span class="p">}</span>

<span class="n">random_search</span> <span class="o">=</span> <span class="kc">None</span>

<span class="c1"># your code here</span>
<span class="k">raise</span> <span class="ne">NotImplementedError</span> <span class="c1"># No Answer - remove if you provide an answer</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s take a look at the scores below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### BEGIN STARTER CODE</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">random_search</span><span class="o">.</span><span class="n">cv_results_</span><span class="p">)[[</span><span class="s2">&quot;params&quot;</span><span class="p">,</span>
                                         <span class="s2">&quot;mean_test_score&quot;</span><span class="p">,</span> 
                                         <span class="s2">&quot;mean_train_score&quot;</span><span class="p">,</span>
                                         <span class="s2">&quot;rank_test_score&quot;</span><span class="p">]]</span>
<span class="c1">### END STARTER CODE</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="choosing-your-hyperparameters">
<h3>3.4 Choosing your hyperparameters<a class="headerlink" href="#choosing-your-hyperparameters" title="Permalink to this headline">¶</a></h3>
<p>rubric={accuracy:2, reasoning:1}</p>
<p>What values for <code class="docutils literal notranslate"><span class="pre">gamma</span></code> and <code class="docutils literal notranslate"><span class="pre">C</span></code> would you choose for your final model and why?</p>
<p>(You can answer this by either looking at the table above or using the methods <code class="docutils literal notranslate"><span class="pre">.best_params_</span></code>  and <code class="docutils literal notranslate"><span class="pre">.best_score_</span></code>)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">best_gamma</span> <span class="o">=</span> <span class="kc">None</span> 
<span class="n">best_c</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">best_score</span> <span class="o">=</span> <span class="kc">None</span> 

<span class="c1"># your code here</span>
<span class="k">raise</span> <span class="ne">NotImplementedError</span> <span class="c1"># No Answer - remove if you provide an answer</span>
</pre></div>
</div>
</div>
</div>
<p>YOUR ANSWER HERE</p>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="evaluating-on-the-test-set-a-name-5-a">
<h1>4. Evaluating on the test set <a name="5"></a><a class="headerlink" href="#evaluating-on-the-test-set-a-name-5-a" title="Permalink to this headline">¶</a></h1>
<hr>
<p>Now that we have a best-performing model, it’s time to assess our model on the test set.</p>
<div class="section" id="scoring-your-final-model">
<h2>4.1 Scoring your final model<a class="headerlink" href="#scoring-your-final-model" title="Permalink to this headline">¶</a></h2>
<p>rubric={accuracy:2}</p>
<p>What is the training and test score of the best scoring model?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># your code here</span>
<span class="k">raise</span> <span class="ne">NotImplementedError</span> <span class="c1"># No Answer - remove if you provide an answer</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="assessing-your-model">
<h2>4.2 Assessing your model<a class="headerlink" href="#assessing-your-model" title="Permalink to this headline">¶</a></h2>
<p>rubric={reasoning:2}</p>
<p>Finalize this report by comparing these scores with the validation scores from the randomized grid search in question 3.3. Compare your final model accuracy with your baseline model from question 3.1. How confident are you in your model? What were some of the downsides of using <code class="docutils literal notranslate"><span class="pre">SVC</span></code>?</p>
<p>YOUR ANSWER HERE</p>
</div>
<div class="section" id="submission-to-canvas">
<h2>Submission to Canvas<a class="headerlink" href="#submission-to-canvas" title="Permalink to this headline">¶</a></h2>
<p><strong>PLEASE READ: When you are ready to submit your assignment do the following:</strong></p>
<ul class="simple">
<li><p>Read through your solutions</p></li>
<li><p><strong>Restart your kernel and clear output and rerun your cells from top to bottom</strong></p></li>
<li><p>Makes sure that none of your code is broken</p></li>
<li><p>Verify that the tests from the questions you answered have obtained the output “Success”</p></li>
<li><p>Convert your notebook to .html format by going to File -&gt; Export Notebook As… -&gt; Export Notebook to HTML</p></li>
<li><p>Upload your <code class="docutils literal notranslate"><span class="pre">.ipynb</span></code> file and the <code class="docutils literal notranslate"><span class="pre">.html</span></code> file to Canvas under Assignment1.</p></li>
<li><p><strong>DO NOT</strong> upload any <code class="docutils literal notranslate"><span class="pre">.csv</span></code> files.</p></li>
</ul>
</div>
<div class="section" id="congratulations-on-finishing-assignment-2-now-you-are-ready-to-build-a-simple-ml-pipeline-on-real-world-datasets">
<h2>Congratulations on finishing Assignment 2! Now you are ready to build a simple ML pipeline on real-world datasets!<a class="headerlink" href="#congratulations-on-finishing-assignment-2-now-you-are-ready-to-build-a-simple-ml-pipeline-on-real-world-datasets" title="Permalink to this headline">¶</a></h2>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "bait509-ubc/BAIT509",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./assignments/assignment2"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Hayley Boyce<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>