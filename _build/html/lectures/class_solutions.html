
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Exercise Solutions &#8212; BAIT 509 - Business Applications of Machine Learning</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://bait509-ubc.github.io/BAIT509/intro.html/lectures/class_solutions.html" />
    <link rel="shortcut icon" href="../_static/bait_logo.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/bait_logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">BAIT 509 - Business Applications of Machine Learning</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p class="caption" role="heading">
 <span class="caption-text">
  Things You Should Know
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../things_to_know/who.html">
   Who: Hayley Boyce
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../things_to_know/how.html">
   How: The Course Structure
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../things_to_know/what.html">
   What: Learning Outcomes
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  Lectures
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="lecture1.html">
   1. Intro to ML &amp;  Decision Trees
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lecture2.html">
   2. Splitting and Cross-validation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lecture3.html">
   3. Baseline, k-Nearest Neighbours
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lecture4.html">
   4. SVM with RBF Kernel and Feature Preprocessing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lecture5.html">
   5. Preprocessing Categorical Features and Column Transformer
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lecture6.html">
   6. Naive Bayes and Hyperparameter Optimization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lecture7.html">
   7. Linear Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lecture8.html">
   8. Business Objectives/Statistical Questions and Feature Selection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lecture9.html">
   9. Classification and Regression Metrics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lecture10.html">
   10. Multi-Class, Pandas Profiling, Finale
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  References
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../things_to_know/attribution.html">
   Attribution
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/lectures/class_solutions.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/bait509-ubc/BAIT509"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/bait509-ubc/BAIT509/issues/new?title=Issue%20on%20page%20%2Flectures/class_solutions.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/bait509-ubc/BAIT509/edit/master/lectures/class_solutions.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/bait509-ubc/BAIT509/master?urlpath=tree/lectures/class_solutions.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Exercise Solutions
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lecture-1">
   Lecture 1
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#let-s-practice">
     Let’s Practice!
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Let’s Practice!
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lecture-2">
   Lecture 2
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     Let’s Practice
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     Let’s Practice
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     Let’s Practice
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lecture-3">
   Lecture 3
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id5">
     Let’s Practice
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id6">
     Let’s Practice
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id7">
     Let’s practice
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lecture-4-svm">
   Lecture 4 - SVM
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id8">
     Let’s Practice
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id9">
     Let’s practice
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lecture-4-pipeline">
   Lecture 4 - Pipeline
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id10">
     Let’s practice
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id11">
     Let’s Practice
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lecture-5">
   Lecture 5
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id12">
     Let’s Practice
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id13">
     Let’s Practice
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id14">
     Let’s Practice
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#coding-practice">
       Coding Practice
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lecture-6">
   Lecture 6
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id15">
     Let’s Practice
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#spam">
       spam
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#non-spam">
       non spam
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#final-class">
       Final Class
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id16">
     Let’s Practice
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id17">
       Coding Practice
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lecture-7">
   Lecture 7
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id18">
     Let’s Practice
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id19">
     Let’s Practice
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#lecture-8">
     Lecture 8
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id20">
     Let’s Practice
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id21">
     Let’s Practice
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#lecture-9">
     Lecture 9
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id22">
     Let’s Practice
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id23">
     Let’s Practice
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id24">
     Let’s Practice
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#lecture-10">
     Lecture 10
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id25">
     Let’s Practice
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="exercise-solutions">
<h1>Exercise Solutions<a class="headerlink" href="#exercise-solutions" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span><span class="p">,</span> <span class="n">cross_validate</span>
<span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <span class="n">SimpleImputer</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span><span class="p">,</span> <span class="n">make_pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">OneHotEncoder</span><span class="p">,</span> <span class="n">OrdinalEncoder</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">,</span> <span class="n">MinMaxScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span>
<span class="kn">from</span> <span class="nn">sklearn.compose</span> <span class="kn">import</span> <span class="n">make_column_transformer</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">CountVectorizer</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="lecture-1">
<h1>Lecture 1<a class="headerlink" href="#lecture-1" title="Permalink to this headline">¶</a></h1>
<div class="section" id="let-s-practice">
<h2>Let’s Practice!<a class="headerlink" href="#let-s-practice" title="Permalink to this headline">¶</a></h2>
<p>Are the following supervised or unsupervised problems?</p>
<ol class="simple">
<li><p>Finding groups of similar properties in a real estate data set.</p></li>
</ol>
<blockquote>
<div><p>Unsupervised</p>
</div></blockquote>
<ol class="simple">
<li><p>Predicting real estate prices based on house features like number of rooms, learning from past sales as examples.</p></li>
</ol>
<blockquote>
<div><p>Supervised</p>
</div></blockquote>
<ol class="simple">
<li><p>Identifying groups of animals given features such as “number of legs”, “wings/no wings”, “fur/no fur”, etc.</p></li>
</ol>
<blockquote>
<div><p>Unsupervised</p>
</div></blockquote>
<ol class="simple">
<li><p>Detecting heart disease in patients based on different test results and history.</p></li>
</ol>
<blockquote>
<div><p>Supervised</p>
</div></blockquote>
<ol class="simple">
<li><p>Grouping articles on different topics from different news sources (something like Google News app).</p></li>
</ol>
<blockquote>
<div><p>Unsupervised</p>
</div></blockquote>
<p>Are the following classification or regression problems?</p>
<ol class="simple">
<li><p>Predicting the price of a house based on features such as number of rooms and the year built.</p></li>
</ol>
<blockquote>
<div><p>Regression</p>
</div></blockquote>
<ol class="simple">
<li><p>Predicting if a house will sell or not based on features like the price of the house, number of rooms, etc.</p></li>
</ol>
<blockquote>
<div><p>Classification</p>
</div></blockquote>
<ol class="simple">
<li><p>Predicting your grade in BAIT 509 based on past grades.</p></li>
</ol>
<blockquote>
<div><p>Regression</p>
</div></blockquote>
<ol class="simple">
<li><p>Predicting whether you should bicycle tomorrow or not based on the weather forecast.</p></li>
</ol>
<blockquote>
<div><p>Classification</p>
</div></blockquote>
<ol class="simple">
<li><p>Predicting a cereal’s manufacturer given the nutritional information.</p></li>
</ol>
<blockquote>
<div><p>Classification</p>
</div></blockquote>
</div>
<div class="section" id="id1">
<h2>Let’s Practice!<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>Using the data <code class="docutils literal notranslate"><span class="pre">candybars.csv</span></code> from the datafolder to aswer the following questions:</p>
<ol class="simple">
<li><p>How many features are there?</p></li>
</ol>
<blockquote>
<div><p>8</p>
</div></blockquote>
<ol class="simple">
<li><p>How many observations are there?</p></li>
</ol>
<blockquote>
<div><p>25</p>
</div></blockquote>
<ol class="simple">
<li><p>What would be a suitable target with this data?</p></li>
</ol>
<blockquote>
<div><p>Probably <code class="docutils literal notranslate"><span class="pre">availability</span></code> but we could use the other features as well.</p>
</div></blockquote>
<p><em><strong>Answer as either <code class="docutils literal notranslate"><span class="pre">fit</span></code>  or <code class="docutils literal notranslate"><span class="pre">predict</span></code></strong></em></p>
<ol class="simple">
<li><p>Is called first (before the other one).</p></li>
</ol>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">fit</span></code></p>
</div></blockquote>
<ol class="simple">
<li><p>Only takes X as an argument.</p></li>
</ol>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">predict</span></code></p>
</div></blockquote>
<ol class="simple">
<li><p>In scikit-learn, we can ignore its output.In scikit-learn, we can ignore its output.</p></li>
</ol>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">fit</span></code></p>
</div></blockquote>
<p><em><strong>Quick Questions</strong></em></p>
<ol class="simple">
<li><p>What is the top node in a decision tree called?</p></li>
</ol>
<blockquote>
<div><p>The root</p>
</div></blockquote>
<ol class="simple">
<li><p>What Python structure/syntax are the nodes in a decision tree similar to?</p></li>
</ol>
<blockquote>
<div><p>If-else statements</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">candy_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/candybars.csv&#39;</span><span class="p">,</span><span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define X and y</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">candy_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;availability&#39;</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">candy_df</span><span class="p">[</span><span class="s1">&#39;availability&#39;</span><span class="p">]</span>

<span class="c1"># Creating a model</span>
<span class="k">for</span> <span class="n">min_samples_split</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">]:</span>
    <span class="n">hyper_tree</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_samples_split</span><span class="o">=</span><span class="n">min_samples_split</span><span class="p">)</span>
    <span class="n">hyper_tree</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;For min_sample_split =&quot;</span><span class="p">,</span><span class="n">min_samples_split</span><span class="p">,</span> <span class="s2">&quot;accuracy=&quot;</span><span class="p">,</span> <span class="n">hyper_tree</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>For min_sample_split = 2 accuracy= 0.84
For min_sample_split = 5 accuracy= 0.68
For min_sample_split = 10 accuracy= 0.64
</pre></div>
</div>
</div>
</div>
<ol class="simple">
<li><p>a) Which <code class="docutils literal notranslate"><span class="pre">min_samples_split</span></code> value would you choose to predict this data? <br></p></li>
</ol>
<blockquote>
<div><p>It has the best accuracy with the lowest value of <code class="docutils literal notranslate"><span class="pre">min_sample_split</span></code>.</p>
</div></blockquote>
<ol class="simple">
<li><p>b) Would you choose the same <code class="docutils literal notranslate"><span class="pre">min_samples_split</span></code> value to predict new data?</p></li>
</ol>
<blockquote>
<div><p>No and we will explain this next lecture.</p>
</div></blockquote>
<ol class="simple">
<li><p>Do you think most of the computational effort for a decision tree takes place in the <code class="docutils literal notranslate"><span class="pre">.fit()</span></code> stage or <code class="docutils literal notranslate"><span class="pre">.predict()</span></code> stage?</p></li>
</ol>
<blockquote>
<div><p>Most of the computational effort takes places in the .fit() stage, when we create the model.</p>
</div></blockquote>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="lecture-2">
<h1>Lecture 2<a class="headerlink" href="#lecture-2" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id2">
<h2>Let’s Practice<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>When is the most optimal time to split our data?</p></li>
</ol>
<blockquote>
<div><p>Before we visualize/explore it.</p>
</div></blockquote>
<ol class="simple">
<li><p>Why do we split our data?</p></li>
</ol>
<blockquote>
<div><p>To help us assess how well our model generalizes.</p>
</div></blockquote>
<ol class="simple">
<li><p>Fill in the table below:</p></li>
</ol>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>datasets</p></th>
<th class="text-align:center head"><p><code class="docutils literal notranslate"><span class="pre">.fit()</span></code></p></th>
<th class="text-align:center head"><p><code class="docutils literal notranslate"><span class="pre">.score()</span></code></p></th>
<th class="text-align:center head"><p><code class="docutils literal notranslate"><span class="pre">.predict()</span></code></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Train</p></td>
<td class="text-align:center"><p>✔️</p></td>
<td class="text-align:center"><p>✔️</p></td>
<td class="text-align:center"><p>✔️</p></td>
</tr>
<tr class="row-odd"><td><p>Validation</p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p>✔️</p></td>
<td class="text-align:center"><p>✔️</p></td>
</tr>
<tr class="row-even"><td><p>Test</p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p>Once</p></td>
<td class="text-align:center"><p>Once</p></td>
</tr>
<tr class="row-odd"><td><p>Deployment</p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p>✔️</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id3">
<h2>Let’s Practice<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>We carry out cross-validation to avoid reusing the same validation set again and again. Let’s say you do 10-fold cross-validation on 1000 examples. For each fold, how many examples do you train on?</p></li>
</ol>
<blockquote>
<div><p>900</p>
</div></blockquote>
<ol class="simple">
<li><p>With 10-fold cross-validation, you split 1000 examples into 10-folds. For each fold, when you are done, you add up the accuracies from each fold and divide by what?</p></li>
</ol>
<blockquote>
<div><p>10</p>
</div></blockquote>
<p>True/False:</p>
<ul class="simple">
<li><p>𝑘-fold cross-validation calls fit 𝑘 times and predict 𝑘 times.</p></li>
</ul>
<blockquote>
<div><p>True</p>
</div></blockquote>
</div>
<div class="section" id="id4">
<h2>Let’s Practice<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>Overfitting or Underfitting:</p>
<ol class="simple">
<li><p>If our train accuracy is much higher than our test accuracy.</p></li>
</ol>
<blockquote>
<div><p>Overfitting</p>
</div></blockquote>
<ol class="simple">
<li><p>If our train accuracy and our test accuracy are both low and relatively similar in value.</p></li>
</ol>
<blockquote>
<div><p>Underfitting</p>
</div></blockquote>
<ol class="simple">
<li><p>If our model is using a Decision Tree Classifier for a classification problem with no limit on <code class="docutils literal notranslate"><span class="pre">max_depth</span></code>.</p></li>
</ol>
<blockquote>
<div><p>Likely overfitting</p>
</div></blockquote>
<p>True or False</p>
<ol class="simple">
<li><p>In supervised learning, the training score is always higher than the validation score.</p></li>
</ol>
<blockquote>
<div><p>False</p>
</div></blockquote>
<ol class="simple">
<li><p>The fundamental tradeoff of ML states that as training score goes up, validation score goes down.</p></li>
</ol>
<blockquote>
<div><p>False</p>
</div></blockquote>
<ol class="simple">
<li><p>More “complicated” models are more likely to overfit than “simple” ones.</p></li>
</ol>
<blockquote>
<div><p>True</p>
</div></blockquote>
<ol class="simple">
<li><p>If our training score is extremely high, that means we’re overfitting.</p></li>
</ol>
<blockquote>
<div><p>False</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bball_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/bball.csv&#39;</span><span class="p">)</span>
<span class="n">bball_df</span> <span class="o">=</span> <span class="n">bball_df</span><span class="p">[(</span><span class="n">bball_df</span><span class="p">[</span><span class="s1">&#39;position&#39;</span><span class="p">]</span> <span class="o">==</span><span class="s1">&#39;G&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">bball_df</span><span class="p">[</span><span class="s1">&#39;position&#39;</span><span class="p">]</span> <span class="o">==</span><span class="s1">&#39;F&#39;</span><span class="p">)]</span>

<span class="c1"># Define X and y</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">bball_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">,</span> <span class="s1">&#39;salary&#39;</span><span class="p">]]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">bball_df</span><span class="p">[</span><span class="s1">&#39;position&#39;</span><span class="p">]</span>

<span class="c1"># 1. Split the dataset</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>

<span class="c1"># 2. Create a model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="c1"># 3. Cross validate</span>
<span class="n">scores</span> <span class="o">=</span> <span class="n">cross_validate</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">return_train_score</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># 4. Covert scores into a dataframe</span>
<span class="n">scores_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>

<span class="c1"># 5. Calculate the mean value of each column</span>
<span class="n">mean_scores</span> <span class="o">=</span> <span class="n">scores_df</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">mean_scores</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>fit_time       0.002964
score_time     0.001910
test_score     0.832667
train_score    0.957826
dtype: float64
</pre></div>
</div>
</div>
</div>
<ol class="simple">
<li><p>Is your model overfitting or underfitting?</p></li>
</ol>
<blockquote>
<div><p>The training score is a little higher than the validation score and thus the model is overfitting.</p>
</div></blockquote>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="lecture-3">
<h1>Lecture 3<a class="headerlink" href="#lecture-3" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id5">
<h2>Let’s Practice<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li></li>
</ol>
<p>Below we have the output of <code class="docutils literal notranslate"><span class="pre">y_train.value_counts()</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Position</span>
<span class="n">Forward</span>     <span class="mi">13</span>
<span class="n">Defense</span>      <span class="mi">7</span>
<span class="n">Goalie</span>       <span class="mi">2</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></div>
</div>
<p>In this scenario, what would a <code class="docutils literal notranslate"><span class="pre">DummyClassifier(strategy='most_frequent')</span></code> model predict on the following observation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>   <span class="n">No</span><span class="o">.</span>  <span class="n">Age</span>  <span class="n">Height</span>  <span class="n">Weight</span>  <span class="n">Experience</span>     <span class="n">Salary</span>
<span class="mi">1</span>   <span class="mi">83</span>   <span class="mi">34</span>     <span class="mi">191</span>     <span class="mi">210</span>          <span class="mi">11</span>  <span class="mf">3200000.0</span>
</pre></div>
</div>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">Forward</span></code></p>
</div></blockquote>
<ol class="simple">
<li></li>
</ol>
<p>When using a regression model, which of the following is not a possible return value from .score(X,y) ?
a) 0.0
b) 1.0
c) -0.1
d) 1.5</p>
<blockquote>
<div><p>1.5</p>
</div></blockquote>
<ol class="simple">
<li></li>
</ol>
<p>Below are the values for <code class="docutils literal notranslate"><span class="pre">y</span></code> that were used to train  <code class="docutils literal notranslate"><span class="pre">DummyRegressor(strategy='mean')</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Grade</span>
<span class="mi">0</span>     <span class="mi">75</span>
<span class="mi">1</span>     <span class="mi">80</span>
<span class="mi">2</span>     <span class="mi">90</span>
<span class="mi">3</span>     <span class="mi">95</span>
<span class="mi">4</span>     <span class="mi">85</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></div>
</div>
<p>What value will the model predict for every example?</p>
<blockquote>
<div><p>85</p>
</div></blockquote>
</div>
<div class="section" id="id6">
<h2>Let’s Practice<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>               
       <span class="n">seeds</span>   <span class="n">shape</span>  <span class="n">sweetness</span>   <span class="n">water</span><span class="o">-</span><span class="n">content</span>      <span class="n">weight</span>    <span class="n">fruit_veg</span>
<span class="mi">0</span>      <span class="mi">1</span>        <span class="mi">0</span>        <span class="mi">35</span>          <span class="mi">84</span>               <span class="mi">100</span>        <span class="n">fruit</span>
<span class="mi">1</span>      <span class="mi">0</span>        <span class="mi">0</span>        <span class="mi">23</span>          <span class="mi">75</span>               <span class="mi">120</span>        <span class="n">fruit</span>
<span class="mi">2</span>      <span class="mi">1</span>        <span class="mi">1</span>        <span class="mi">15</span>          <span class="mi">90</span>              <span class="mi">1360</span>         <span class="n">veg</span>
<span class="mi">3</span>      <span class="mi">1</span>        <span class="mi">1</span>         <span class="mi">7</span>          <span class="mi">96</span>               <span class="mi">600</span>         <span class="n">veg</span>
<span class="mi">4</span>      <span class="mi">0</span>        <span class="mi">0</span>        <span class="mi">37</span>          <span class="mi">80</span>                 <span class="mi">5</span>        <span class="n">fruit</span>
<span class="mi">5</span>      <span class="mi">0</span>        <span class="mi">0</span>        <span class="mi">45</span>          <span class="mi">78</span>                <span class="mi">40</span>        <span class="n">fruit</span>  
<span class="mi">6</span>      <span class="mi">1</span>        <span class="mi">0</span>        <span class="mi">27</span>          <span class="mi">83</span>               <span class="mi">450</span>         <span class="n">veg</span>
<span class="mi">7</span>      <span class="mi">1</span>        <span class="mi">1</span>        <span class="mi">18</span>          <span class="mi">73</span>                 <span class="mi">5</span>         <span class="n">veg</span>
<span class="mi">8</span>      <span class="mi">1</span>        <span class="mi">1</span>        <span class="mi">32</span>          <span class="mi">80</span>                <span class="mi">76</span>         <span class="n">veg</span>
<span class="mi">9</span>      <span class="mi">0</span>        <span class="mi">0</span>        <span class="mi">40</span>          <span class="mi">83</span>                <span class="mi">65</span>        <span class="n">fruit</span>
</pre></div>
</div>
<ol class="simple">
<li><p>Giving the table above and that we are trying to predict if each example is either a fruit or a vegetable, what would be the dimension of feature vectors in this problem?</p></li>
</ol>
<blockquote>
<div><p>5 dimensions!</p>
</div></blockquote>
<ol>
<li><p>Which of the following would be the feature vector for example 0.</p>
<p>a) <code class="docutils literal notranslate"><span class="pre">array([1,</span>&#160; <span class="pre">0,</span> <span class="pre">1,</span> <span class="pre">1,</span> <span class="pre">0,</span> <span class="pre">0,</span> <span class="pre">1,</span> <span class="pre">1,</span> <span class="pre">1,</span> <span class="pre">0])</span></code></p>
<p>b) <code class="docutils literal notranslate"><span class="pre">array([fruit,</span>&#160; <span class="pre">fruit,</span> <span class="pre">veg,</span> <span class="pre">veg,</span> <span class="pre">fruit,</span> <span class="pre">fruit,</span> <span class="pre">veg,</span> <span class="pre">veg,</span> <span class="pre">veg,</span> <span class="pre">fruit])</span></code></p>
<p>c) <code class="docutils literal notranslate"><span class="pre">array([1,</span> <span class="pre">0,</span> <span class="pre">35,</span> <span class="pre">84,</span> <span class="pre">100])</span></code></p>
<p>d) <code class="docutils literal notranslate"><span class="pre">array([1,</span> <span class="pre">0,</span> <span class="pre">35,</span> <span class="pre">84,</span> <span class="pre">100,</span>&#160; <span class="pre">fruit])</span></code></p>
</li>
</ol>
<blockquote>
<div><p>c) <code class="docutils literal notranslate"><span class="pre">array([1,</span> <span class="pre">0,</span> <span class="pre">35,</span> <span class="pre">84,</span> <span class="pre">100])</span></code></p>
</div></blockquote>
<ol>
<li><p>Given the following 2 feature vectors, what is the Euclidean distance between the following two feature vectors?</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="o">-</span><span class="mi">11</span><span class="p">])</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span><span class="p">])</span>
</pre></div>
</div>
</li>
</ol>
<blockquote>
<div><p>7</p>
</div></blockquote>
<p><strong>True or False</strong></p>
<ol class="simple">
<li><p>Analogy-based models find examples from the test set that are most similar to the test example we are predicting.</p></li>
</ol>
<blockquote>
<div><p>False</p>
</div></blockquote>
<ol class="simple">
<li><p>Feature vectors can only be of length 3 since we cannot visualize past that.</p></li>
</ol>
<blockquote>
<div><p>False</p>
</div></blockquote>
<ol class="simple">
<li><p>A dataset with 10 dimensions is considered low dimensional.</p></li>
</ol>
<blockquote>
<div><p>True</p>
</div></blockquote>
<ol class="simple">
<li><p>Euclidean distance will always have a positive value.</p></li>
</ol>
<blockquote>
<div><p>True (0 and positive)</p>
</div></blockquote>
<ol class="simple">
<li><p>When finding the nearest neighbour in a dataset using <code class="docutils literal notranslate"><span class="pre">kneighbors()</span></code> from the <code class="docutils literal notranslate"><span class="pre">sklearn</span></code> library, we must <code class="docutils literal notranslate"><span class="pre">fit</span></code>  the data first.</p></li>
</ol>
<blockquote>
<div><p>True</p>
</div></blockquote>
<ol class="simple">
<li><p>Calculating the distances between an example and a query point takes twice as long as calculating the distances between two examples.</p></li>
</ol>
<blockquote>
<div><p>False</p>
</div></blockquote>
</div>
<div class="section" id="id7">
<h2>Let’s practice<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h2>
<p>Consider this toy dataset:</p>
<div class="math notranslate nohighlight">
\[\begin{split} X = \begin{bmatrix}5 &amp; 2\\4 &amp; 3\\  2 &amp; 2\\ 10 &amp; 10\\ 9 &amp; -1\\ 9&amp; 9\end{bmatrix}, \quad y = \begin{bmatrix}0\\0\\1\\1\\1\\2\end{bmatrix}.\end{split}\]</div>
<ol class="simple">
<li><p>If <span class="math notranslate nohighlight">\(k=1\)</span>, what would you predict for <span class="math notranslate nohighlight">\(x=\begin{bmatrix} 0\\0\end{bmatrix}\)</span>?</p></li>
</ol>
<blockquote>
<div><p>1</p>
</div></blockquote>
<ol class="simple">
<li><p>If <span class="math notranslate nohighlight">\(k=3\)</span>, what would you predict for <span class="math notranslate nohighlight">\(x=\begin{bmatrix} 0\\0\end{bmatrix}\)</span>?</p></li>
</ol>
<blockquote>
<div><p>0</p>
</div></blockquote>
<p><strong>True or False</strong></p>
<ol class="simple">
<li><p>The classification of the closest neighbour to the test example always contributes the most to the prediction</p></li>
</ol>
<blockquote>
<div><p>False</p>
</div></blockquote>
<ol class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">n_neighbors</span></code> hyperparameter must be less than the number of examples in the training set.</p></li>
</ol>
<blockquote>
<div><p>True</p>
</div></blockquote>
<ol class="simple">
<li><p>Similar to decision trees, <span class="math notranslate nohighlight">\(k\)</span>-NNs find a small set of good features.</p></li>
</ol>
<blockquote>
<div><p>False</p>
</div></blockquote>
<ol class="simple">
<li><p>With  <span class="math notranslate nohighlight">\(k\)</span> -NN, setting the hyperparameter  <span class="math notranslate nohighlight">\(k\)</span>  to larger values typically increases training score.</p></li>
</ol>
<blockquote>
<div><p>False</p>
</div></blockquote>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(k\)</span>-NN may perform poorly in high-dimensional space (say, d &gt; 100)</p></li>
</ol>
<blockquote>
<div><p>True</p>
</div></blockquote>
<p>Consider this graph:</p>
<a class="reference internal image-reference" href="../_images/Q18a.png"><img alt="404 image" src="../_images/Q18a.png" style="width: 50%;" /></a>
<ol class="simple">
<li><p>What value of <code class="docutils literal notranslate"><span class="pre">n_neighbors</span></code> would you choose to train your model on?</p></li>
</ol>
<blockquote>
<div><p>12</p>
</div></blockquote>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="lecture-4-svm">
<h1>Lecture 4 - SVM<a class="headerlink" href="#lecture-4-svm" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id8">
<h2>Let’s Practice<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[\begin{split} X = \begin{bmatrix}5 &amp; 2\\4 &amp; 3\\  2 &amp; 2\\ 10 &amp; 10\\ 9 &amp; -1\\ 9&amp; 9\end{bmatrix}, \quad y = \begin{bmatrix}0\\0\\1\\1\\1\\2\end{bmatrix}.\end{split}\]</div>
<p>If <span class="math notranslate nohighlight">\(k=3\)</span>, what would you predict for <span class="math notranslate nohighlight">\(x=\begin{bmatrix} 0\\0\end{bmatrix}\)</span> if we were doing regression rather than classification?</p>
<blockquote>
<div><p>1/3</p>
</div></blockquote>
</div>
<div class="section" id="id9">
<h2>Let’s practice<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h2>
<p><strong>True or False</strong></p>
<p>1.In Scikit Learn’s SVC classifier, large values of gamma tend to result in higher training scores but probably lower validation scores.</p>
<blockquote>
<div><p>True</p>
</div></blockquote>
<p>2.If we increase both <code class="docutils literal notranslate"><span class="pre">gamma</span></code> and <code class="docutils literal notranslate"><span class="pre">C</span></code>, we can’t be certain if the model becomes more complex or less complex.</p>
<blockquote>
<div><p>False</p>
</div></blockquote>
<p><strong>Coding practice</strong></p>
<p>Below is some starter code that creates your feature table and target column from the data from the <code class="docutils literal notranslate"><span class="pre">bball.csv</span></code> dataset (in the data folder).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bball_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/bball.csv&#39;</span><span class="p">)</span>
<span class="n">bball_df</span> <span class="o">=</span> <span class="n">bball_df</span><span class="p">[(</span><span class="n">bball_df</span><span class="p">[</span><span class="s1">&#39;position&#39;</span><span class="p">]</span> <span class="o">==</span><span class="s1">&#39;G&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">bball_df</span><span class="p">[</span><span class="s1">&#39;position&#39;</span><span class="p">]</span> <span class="o">==</span><span class="s1">&#39;F&#39;</span><span class="p">)]</span>

<span class="c1"># Define X and y</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">bball_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">,</span> <span class="s1">&#39;salary&#39;</span><span class="p">]]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">bball_df</span><span class="p">[</span><span class="s1">&#39;position&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<ol class="simple">
<li><p>Split the dataset into 4 objects: <code class="docutils literal notranslate"><span class="pre">X_train</span></code>, <code class="docutils literal notranslate"><span class="pre">X_test</span></code>, <code class="docutils literal notranslate"><span class="pre">y_train</span></code>, <code class="docutils literal notranslate"><span class="pre">y_test</span></code>. Make the test set 0.2 (or the train set 0.8) and make sure to use <code class="docutils literal notranslate"><span class="pre">random_state=7</span></code>.</p></li>
<li><p>Create an <code class="docutils literal notranslate"><span class="pre">SVM</span></code> model with <code class="docutils literal notranslate"><span class="pre">gamma</span></code> equal to 0.1 and <code class="docutils literal notranslate"><span class="pre">C</span></code> equal to 10.</p></li>
<li><p>Cross-validate using cross_validate() on the objects X_train and y_train specifying the model and making sure to use 5 fold cross-validation and <code class="docutils literal notranslate"><span class="pre">return_train_score=True</span></code>.</p></li>
<li><p>Calculate the mean training and cross-validation scores.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. Split the dataset</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>

<span class="c1"># 2. Create a model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">(</span><span class="n">gamma</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># 3. Cross-validate</span>
<span class="n">scores_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">cross_validate</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">return_train_score</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

<span class="c1"># 4.  Calculate the mean training and cross-validation scores.</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The mean training score is&#39;</span><span class="p">,</span> <span class="n">scores_df</span><span class="o">.</span><span class="n">mean</span><span class="p">()[</span><span class="s1">&#39;train_score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;and the mean validation score is&#39;</span><span class="p">,</span> <span class="n">scores_df</span><span class="o">.</span><span class="n">mean</span><span class="p">()[</span><span class="s1">&#39;test_score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The mean training score is 0.996 and the mean validation score is 0.559
</pre></div>
</div>
</div>
</div>
<p>Yikes! I wonder how this can be improved?! More on this in the next class :)</p>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="lecture-4-pipeline">
<h1>Lecture 4 - Pipeline<a class="headerlink" href="#lecture-4-pipeline" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id10">
<h2>Let’s practice<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>Name a model that will still produce meaningful predictions with different scaled column values.</p></li>
</ol>
<blockquote>
<div><p>Decision Tree Algorithm</p>
</div></blockquote>
<ol class="simple">
<li><p>Complete the following statement: Preprocessing is done ____.</p></li>
</ol>
<ul class="simple">
<li><p>To the model but before training</p></li>
<li><p>To the data before training the model</p></li>
<li><p>To the model after training</p></li>
<li><p>To the data after training the model</p></li>
</ul>
<blockquote>
<div><p>To the data before training the model</p>
</div></blockquote>
<ol class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">StandardScaler</span></code> is a type of what?</p></li>
</ol>
<blockquote>
<div><p>Transformer</p>
</div></blockquote>
<ol class="simple">
<li><p>What data splits does <code class="docutils literal notranslate"><span class="pre">StandardScaler</span></code> alter (Training, Testing, Validation, None, All)?</p></li>
</ol>
<blockquote>
<div><p>All</p>
</div></blockquote>
<p><strong>True or False</strong></p>
<ol class="simple">
<li><p>Columns with lower magnitudes compared to columns with higher magnitudes are less important when making predictions.</p></li>
</ol>
<blockquote>
<div><p>False</p>
</div></blockquote>
<ol class="simple">
<li><p>A model less sensitive to the scale of the data makes it more robust.</p></li>
</ol>
<blockquote>
<div><p>True</p>
</div></blockquote>
</div>
<div class="section" id="id11">
<h2>Let’s Practice<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>When/Why do we need to impute our data?</p></li>
</ol>
<blockquote>
<div><p>When we have missing data.</p>
</div></blockquote>
<ol class="simple">
<li><p>If we have <code class="docutils literal notranslate"><span class="pre">NaN</span></code> values in our data, can we simply drop the column missing the data?</p></li>
</ol>
<blockquote>
<div><p>Yes, if the majority of the values are missing from the column</p>
</div></blockquote>
<ol class="simple">
<li><p>Which scaling method will never produce negative values?</p></li>
</ol>
<blockquote>
<div><p>Normalization (<code class="docutils literal notranslate"><span class="pre">MinMaxScaler</span></code>)</p>
</div></blockquote>
<ol class="simple">
<li><p>Which scaling method will never produce values greater than 1?</p></li>
</ol>
<blockquote>
<div><p>Normalization (<code class="docutils literal notranslate"><span class="pre">MinMaxScaler</span></code>)</p>
</div></blockquote>
<ol class="simple">
<li><p>Which scaling method will produce values where the range depends on the values in the data?</p></li>
</ol>
<blockquote>
<div><p>Standardization (<code class="docutils literal notranslate"><span class="pre">StandardScaler</span></code>)</p>
</div></blockquote>
<p><strong>True or False</strong><br />
6. <code class="docutils literal notranslate"><span class="pre">SimpleImputer</span></code> is a type of transformer.</p>
<blockquote>
<div><p>True</p>
</div></blockquote>
<ol class="simple">
<li><p>Scaling is a form of transformation.</p></li>
</ol>
<blockquote>
<div><p>True</p>
</div></blockquote>
<ol class="simple">
<li><p>We can use <code class="docutils literal notranslate"><span class="pre">SimpleImputer</span></code> to impute values that are missing from numerical and categorical columns.</p></li>
</ol>
<blockquote>
<div><p>True</p>
</div></blockquote>
<ol class="simple">
<li><p>Which of the following steps cannot be used in a pipeline?</p>
<ul class="simple">
<li><p>Scaling</p></li>
<li><p>Model building</p></li>
<li><p>Imputation</p></li>
<li><p>Data Splitting</p></li>
</ul>
</li>
</ol>
<blockquote>
<div><p>Data Splitting</p>
</div></blockquote>
<ol class="simple">
<li><p>Why can’t we fit and transform the training and test data together?</p></li>
</ol>
<blockquote>
<div><p>It’s violating the golden rule.</p>
</div></blockquote>
<p><strong>True or False</strong><br />
3. We have to be careful of the order we put each transformation and model in a pipeline.</p>
<blockquote>
<div><p>True</p>
</div></blockquote>
<ol class="simple">
<li><p>Pipelines will fit and transform on both the training and validation folds during cross-validation.</p></li>
</ol>
<blockquote>
<div><p>False</p>
</div></blockquote>
<p>Let’s bring in the basketball dataset again.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Loading in the data</span>
<span class="n">bball_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/bball.csv&#39;</span><span class="p">)</span>
<span class="n">bball_df</span> <span class="o">=</span> <span class="n">bball_df</span><span class="p">[(</span><span class="n">bball_df</span><span class="p">[</span><span class="s1">&#39;position&#39;</span><span class="p">]</span> <span class="o">==</span><span class="s1">&#39;G&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">bball_df</span><span class="p">[</span><span class="s1">&#39;position&#39;</span><span class="p">]</span> <span class="o">==</span><span class="s1">&#39;F&#39;</span><span class="p">)]</span>

<span class="c1"># Define X and y</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">bball_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">,</span> <span class="s1">&#39;salary&#39;</span><span class="p">]]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">bball_df</span><span class="p">[</span><span class="s1">&#39;position&#39;</span><span class="p">]</span>

<span class="c1"># Split the dataset</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Build a pipeline named <code class="docutils literal notranslate"><span class="pre">bb_pipe</span></code> that:</p>
<ol class="simple">
<li><p>Imputes using “median” as a strategy,</p></li>
<li><p>scale using <code class="docutils literal notranslate"><span class="pre">StandardScaler</span></code></p></li>
<li><p>builds a <code class="docutils literal notranslate"><span class="pre">KNeighborsClassifier</span></code>.</p></li>
</ol>
<p>Next, do 5 fold cross-validation on the pipeline using <code class="docutils literal notranslate"><span class="pre">X_train</span></code> and <code class="docutils literal notranslate"><span class="pre">y_train</span></code> and save the results in an dataframe.
Take the mean of each column and assess your model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Build a pipeline</span>
<span class="n">bb_pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
            <span class="n">steps</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;imputer&quot;</span><span class="p">,</span> <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;median&quot;</span><span class="p">)),</span>
                   <span class="p">(</span><span class="s2">&quot;scaler&quot;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span>
                   <span class="p">(</span><span class="s2">&quot;knn&quot;</span><span class="p">,</span> <span class="n">KNeighborsClassifier</span><span class="p">())])</span>

<span class="c1"># Do 5 fold cross-validation on the pipeline using `X_train` and `y_train` and save the results in an dataframe.</span>
<span class="n">cross_scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">cross_validate</span><span class="p">(</span><span class="n">bb_pipe</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">return_train_score</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

<span class="c1"># Transform cross_scores to a dataframe and take the mean of each column</span>
<span class="c1"># Save the result in an object named mean_scores</span>
<span class="n">mean_scores</span> <span class="o">=</span> <span class="n">cross_scores</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">mean_scores</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>fit_time       0.009682
score_time     0.006163
test_score     0.881633
train_score    0.915306
dtype: float64
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="lecture-5">
<h1>Lecture 5<a class="headerlink" href="#lecture-5" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id12">
<h2>Let’s Practice<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>           <span class="n">name</span>    <span class="n">colour</span>    <span class="n">location</span>    <span class="n">seed</span>   <span class="n">shape</span>  <span class="n">sweetness</span>   <span class="n">water</span><span class="o">-</span><span class="n">content</span>  <span class="n">weight</span>  <span class="n">popularity</span>
<span class="mi">0</span>         <span class="n">apple</span>       <span class="n">red</span>     <span class="n">canada</span>    <span class="kc">True</span>   <span class="nb">round</span>     <span class="kc">True</span>          <span class="mi">84</span>         <span class="mi">100</span>      <span class="n">popular</span>
<span class="mi">1</span>        <span class="n">banana</span>    <span class="n">yellow</span>     <span class="n">mexico</span>   <span class="kc">False</span>    <span class="n">long</span>     <span class="kc">True</span>          <span class="mi">75</span>         <span class="mi">120</span>      <span class="n">popular</span>
<span class="mi">2</span>    <span class="n">cantaloupe</span>    <span class="n">orange</span>      <span class="n">spain</span>    <span class="kc">True</span>   <span class="nb">round</span>     <span class="kc">True</span>          <span class="mi">90</span>        <span class="mi">1360</span>      <span class="n">neutral</span>
<span class="mi">3</span>  <span class="n">dragon</span><span class="o">-</span><span class="n">fruit</span>   <span class="n">magenta</span>      <span class="n">china</span>    <span class="kc">True</span>   <span class="nb">round</span>    <span class="kc">False</span>          <span class="mi">96</span>         <span class="mi">600</span>      <span class="ow">not</span> <span class="n">popular</span>
<span class="mi">4</span>    <span class="n">elderberry</span>    <span class="n">purple</span>    <span class="n">austria</span>   <span class="kc">False</span>   <span class="nb">round</span>     <span class="kc">True</span>          <span class="mi">80</span>           <span class="mi">5</span>      <span class="ow">not</span> <span class="n">popular</span>
<span class="mi">5</span>           <span class="n">fig</span>    <span class="n">purple</span>     <span class="n">turkey</span>   <span class="kc">False</span>    <span class="n">oval</span>    <span class="kc">False</span>          <span class="mi">78</span>          <span class="mi">40</span>      <span class="n">neutral</span>
<span class="mi">6</span>         <span class="n">guava</span>     <span class="n">green</span>     <span class="n">mexico</span>    <span class="kc">True</span>    <span class="n">oval</span>     <span class="kc">True</span>          <span class="mi">83</span>         <span class="mi">450</span>      <span class="n">neutral</span>
<span class="mi">7</span>   <span class="n">huckleberry</span>      <span class="n">blue</span>     <span class="n">canada</span>    <span class="kc">True</span>   <span class="nb">round</span>     <span class="kc">True</span>          <span class="mi">73</span>           <span class="mi">5</span>      <span class="ow">not</span> <span class="n">popular</span>
<span class="mi">8</span>          <span class="n">kiwi</span>     <span class="n">brown</span>      <span class="n">china</span>    <span class="kc">True</span>   <span class="nb">round</span>     <span class="kc">True</span>          <span class="mi">80</span>          <span class="mi">76</span>      <span class="n">popular</span>
<span class="mi">9</span>         <span class="n">lemon</span>    <span class="n">yellow</span>     <span class="n">mexico</span>   <span class="kc">False</span>    <span class="n">oval</span>    <span class="kc">False</span>          <span class="mi">83</span>          <span class="mi">65</span>      <span class="n">popular</span>

</pre></div>
</div>
<ol class="simple">
<li><p>What would be the unique values given to the categories in the <code class="docutils literal notranslate"><span class="pre">popularity</span></code> column, if we transformed it with ordinal encoding?</p></li>
</ol>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">4,</span> <span class="pre">5,</span> <span class="pre">6,</span> <span class="pre">7,</span> <span class="pre">8,</span> <span class="pre">9]</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">1,</span> <span class="pre">2]</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">2,</span> <span class="pre">3]</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3]</span></code></p></li>
</ul>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">1,</span> <span class="pre">2]</span></code></p>
</div></blockquote>
<ol class="simple">
<li><p>Does it make sense to be doing ordinal transformations on the <code class="docutils literal notranslate"><span class="pre">colour</span></code> column?</p></li>
</ol>
<blockquote>
<div><p>No</p>
</div></blockquote>
<ol class="simple">
<li><p>If we one hot encoded the <code class="docutils literal notranslate"><span class="pre">shape</span></code> column, what datatype would be the output after using <code class="docutils literal notranslate"><span class="pre">transform</span></code>?</p></li>
</ol>
<blockquote>
<div><p>NumPy array</p>
</div></blockquote>
<ol class="simple">
<li><p>Which of the following outputs is the result of one-hot encoding the <code class="docutils literal notranslate"><span class="pre">shape</span></code> column?</p></li>
</ol>
<p>a)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
</pre></div>
</div>
<p>b)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
</pre></div>
</div>
<p>c)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
</pre></div>
</div>
<p>d)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">5</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">5</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">4</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">]])</span>

</pre></div>
</div>
<blockquote>
<div><p>B</p>
</div></blockquote>
<ol class="simple">
<li><p>On which column(s) would you use <code class="docutils literal notranslate"><span class="pre">OneHotEncoder(sparse=False,</span> <span class="pre">dtype=int,</span> <span class="pre">drop=&quot;if_binary&quot;)</span></code>?</p></li>
</ol>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">seed</span></code>, <code class="docutils literal notranslate"><span class="pre">sweetness</span></code></p>
</div></blockquote>
<p><strong>True or False?</strong></p>
<ol class="simple">
<li><p>Whenever we have categorical values, we should use ordinal encoding.</p></li>
</ol>
<blockquote>
<div><p>False</p>
</div></blockquote>
<ol class="simple">
<li><p>If we include categorical values in our feature table, <code class="docutils literal notranslate"><span class="pre">sklearn</span></code> will throw an error.</p></li>
</ol>
<blockquote>
<div><p>True</p>
</div></blockquote>
<ol class="simple">
<li><p>One-hot encoding a column with 5 unique categories will produce 5 new transformed columns.</p></li>
</ol>
<blockquote>
<div><p>True</p>
</div></blockquote>
<ol class="simple">
<li><p>The values in the new transformed columns after one-hot encoding, are all possible integer or float values.</p></li>
</ol>
<blockquote>
<div><p>False</p>
</div></blockquote>
<ol class="simple">
<li><p>It’s important to be mindful of the consequences of including certain features in your predictive model.</p></li>
</ol>
<blockquote>
<div><p>True</p>
</div></blockquote>
</div>
<div class="section" id="id13">
<h2>Let’s Practice<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h2>
<p>Refer to the dataframe to answer the following question.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>       <span class="n">colour</span>   <span class="n">location</span>    <span class="n">shape</span>   <span class="n">water_content</span>  <span class="n">weight</span>
<span class="mi">0</span>       <span class="n">red</span>      <span class="n">canada</span>      <span class="n">NaN</span>         <span class="mi">84</span>          <span class="mi">100</span>
<span class="mi">1</span>     <span class="n">yellow</span>     <span class="n">mexico</span>     <span class="n">long</span>         <span class="mi">75</span>          <span class="mi">120</span>
<span class="mi">2</span>     <span class="n">orange</span>     <span class="n">spain</span>       <span class="n">NaN</span>         <span class="mi">90</span>          <span class="n">NaN</span>
<span class="mi">3</span>    <span class="n">magenta</span>     <span class="n">china</span>      <span class="nb">round</span>        <span class="n">NaN</span>         <span class="mi">600</span>
<span class="mi">4</span>     <span class="n">purple</span>    <span class="n">austria</span>      <span class="n">NaN</span>         <span class="mi">80</span>          <span class="mi">115</span>
<span class="mi">5</span>     <span class="n">purple</span>    <span class="n">turkey</span>      <span class="n">oval</span>         <span class="mi">78</span>          <span class="mi">340</span>
<span class="mi">6</span>     <span class="n">green</span>     <span class="n">mexico</span>      <span class="n">oval</span>         <span class="mi">83</span>          <span class="n">NaN</span>
<span class="mi">7</span>      <span class="n">blue</span>     <span class="n">canada</span>      <span class="nb">round</span>        <span class="mi">73</span>          <span class="mi">535</span>
<span class="mi">8</span>     <span class="n">brown</span>     <span class="n">china</span>        <span class="n">NaN</span>         <span class="n">NaN</span>        <span class="mi">1743</span>  
<span class="mi">9</span>     <span class="n">yellow</span>    <span class="n">mexico</span>      <span class="n">oval</span>         <span class="mi">83</span>          <span class="mi">265</span>
</pre></div>
</div>
<br>
<ol class="simple">
<li><p>How many categorical columns are there and how many numeric?</p></li>
</ol>
<blockquote>
<div><p>3 categoric columns and 2 numeric columns</p>
</div></blockquote>
<ol class="simple">
<li><p>What transformations are being done to both numeric and categorical columns?</p></li>
</ol>
<blockquote>
<div><p>Imputation</p>
</div></blockquote>
<p>Use the diagram below to answer the following questions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pipeline</span><span class="p">(</span>
    <span class="n">steps</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;columntransformer&#39;</span><span class="p">,</span>
               <span class="n">ColumnTransformer</span><span class="p">(</span>
                  <span class="n">transformers</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;pipeline-1&#39;</span><span class="p">,</span>
                                  <span class="n">Pipeline</span><span class="p">(</span>
                                    <span class="n">steps</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;simpleimputer&#39;</span><span class="p">,</span>
                                             <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;median&#39;</span><span class="p">)),</span>
                                           <span class="p">(</span><span class="s1">&#39;standardscaler&#39;</span><span class="p">,</span>
                                             <span class="n">StandardScaler</span><span class="p">())]),</span>
                      <span class="p">[</span><span class="s1">&#39;water_content&#39;</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">,</span> <span class="s1">&#39;carbs&#39;</span><span class="p">]),</span>
                                <span class="p">(</span><span class="s1">&#39;pipeline-2&#39;</span><span class="p">,</span>
                                  <span class="n">Pipeline</span><span class="p">(</span>
                                    <span class="n">steps</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;simpleimputer&#39;</span><span class="p">,</span>
                                             <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">fill_value</span><span class="o">=</span><span class="s1">&#39;missing&#39;</span><span class="p">,</span>
                                                                <span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;constant&#39;</span><span class="p">)),</span>
                                           <span class="p">(</span><span class="s1">&#39;onehotencoder&#39;</span><span class="p">,</span>
                                             <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">handle_unknown</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">))]),</span>
                      <span class="p">[</span><span class="s1">&#39;colour&#39;</span><span class="p">,</span> <span class="s1">&#39;location&#39;</span><span class="p">,</span> <span class="s1">&#39;seed&#39;</span><span class="p">,</span> <span class="s1">&#39;shape&#39;</span><span class="p">,</span> <span class="s1">&#39;sweetness&#39;</span><span class="p">,</span>
                                                   <span class="s1">&#39;tropical&#39;</span><span class="p">])])),</span>
         <span class="p">(</span><span class="s1">&#39;decisiontreeclassifier&#39;</span><span class="p">,</span> <span class="n">DecisionTreeClassifier</span><span class="p">())])</span>
</pre></div>
</div>
<ol class="simple">
<li><p>How many columns are being transformed in <code class="docutils literal notranslate"><span class="pre">pipeline-1</span></code>?</p></li>
</ol>
<blockquote>
<div><p>3</p>
</div></blockquote>
<ol class="simple">
<li><p>Which pipeline is transforming the categorical columns?</p></li>
</ol>
<blockquote>
<div><p>pipeline-2</p>
</div></blockquote>
<ol class="simple">
<li><p>What model is the pipeline fitting on?</p></li>
</ol>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">DecisionTreeClassifier</span></code></p>
</div></blockquote>
<p><strong>True or False</strong><br />
6. If there are missing values in both numeric and categorical columns, we can specify this in a single step in the main pipeline.</p>
<blockquote>
<div><p>False</p>
</div></blockquote>
<ol class="simple">
<li><p>If we do not specify <code class="docutils literal notranslate"><span class="pre">remainder=&quot;passthrough&quot;</span></code> as an argument in <code class="docutils literal notranslate"><span class="pre">ColumnTransformer</span></code>, the columns not being transformed will be dropped.</p></li>
</ol>
<blockquote>
<div><p>True</p>
</div></blockquote>
<ol class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Pipeline()</span></code> is the same as <code class="docutils literal notranslate"><span class="pre">make_pipeline()</span></code> but  <code class="docutils literal notranslate"><span class="pre">make_pipeline()</span></code> requires you to name the steps.</p></li>
</ol>
<blockquote>
<div><p>False</p>
</div></blockquote>
</div>
<div class="section" id="id14">
<h2>Let’s Practice<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li></li>
</ol>
<p>What is the size of the vocabulary for the examples below?</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="p">[</span> <span class="s2">&quot;Take me to the river&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Drop me in the water&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Push me in the river&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dip me in the water&quot;</span><span class="p">]</span>
</pre></div>
</div>
<blockquote>
<div><p>10</p>
</div></blockquote>
<ol class="simple">
<li></li>
</ol>
<p>Which of the following is not a hyperparameter of <code class="docutils literal notranslate"><span class="pre">CountVectorizer()</span></code>?</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">binary</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_features</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">vocab</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ngram_range</span></code></p></li>
</ul>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">vocab</span></code></p>
</div></blockquote>
<ol class="simple">
<li><p>What kind of representation do we use for our vocabulary?</p></li>
</ol>
<blockquote>
<div><p>Bag of Words</p>
</div></blockquote>
<p><strong>True or False</strong></p>
<ol class="simple">
<li><p>As you increase the value for the <code class="docutils literal notranslate"><span class="pre">max_features</span></code> hyperparameter of <code class="docutils literal notranslate"><span class="pre">CountVectorizer</span></code>, the training score is likely to go up.</p></li>
</ol>
<blockquote>
<div><p>True</p>
</div></blockquote>
<ol class="simple">
<li><p>If we encounter a word in the validation or the test split that’s not available in the training data, we’ll get an error.</p></li>
</ol>
<blockquote>
<div><p>False</p>
</div></blockquote>
<div class="section" id="coding-practice">
<h3>Coding Practice<a class="headerlink" href="#coding-practice" title="Permalink to this headline">¶</a></h3>
<p>We are going to bring in a new dataset for you to practice on. (Make sure you’ve downloaded it from the <code class="docutils literal notranslate"><span class="pre">data</span></code> folder from the <code class="docutils literal notranslate"><span class="pre">lectures</span></code> section in Canvas).</p>
<p>This dataset contains a text column containing tweets associated with disaster keywords and a target column denoting whether a tweet is about a real disaster (1) or not (0). [<span class="xref myst">Source</span>]</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Loading in the data</span>
<span class="n">tweets_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/balanced_tweets.csv&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">])</span>

<span class="c1"># Split the dataset into the feature table `X` and the target value `y`</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">tweets_df</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">tweets_df</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>

<span class="c1"># Split the dataset into X_train, X_test, y_train, y_test </span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>

<span class="n">X_train</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3219    Buri handwoven bags : • Buri handbag - Php 280...
3825    Energetic and Comedic Redhead Teen, just seen ...
1544    A 63 year old man charged in connection with a...
1050    Water levels in Venice drastically drop two mo...
296     2 buildings on fire at seminole State College ...
Name: text, dtype: object
</pre></div>
</div>
</div>
</div>
<ol class="simple">
<li><p>Make a pipeline with <code class="docutils literal notranslate"><span class="pre">CountVectorizer</span></code> as the first step and <code class="docutils literal notranslate"><span class="pre">SVC()</span></code> as the second.</p></li>
<li><p>Perform 5 fold cross-validation using your pipeline and return the training score.</p></li>
<li><p>Convert the results into a dataframe.</p></li>
<li><p>What are the mean training and validation scores?</p></li>
<li><p>Train your pipeline on the training set.</p></li>
<li><p>Score the pipeline  on the test set.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. Make a pipeline with `CountVectorizer` as the first step and `SVC()` as the second</span>
<span class="n">pipe</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span><span class="n">CountVectorizer</span><span class="p">(),</span> <span class="n">SVC</span><span class="p">())</span>

<span class="c1"># 2. Perform 5 fold cross-validation using your pipeline and return the training score</span>
<span class="n">cv_scores</span> <span class="o">=</span> <span class="n">cross_validate</span><span class="p">(</span><span class="n">pipe</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">return_train_score</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># 3. Convert the results into a dataframe</span>
<span class="n">cv_scores_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">cv_scores</span><span class="p">)</span>

<span class="c1"># 4. What are the mean training and validation scores?</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mean training score:&#39;</span><span class="p">,</span> <span class="n">cv_scores_df</span><span class="o">.</span><span class="n">mean</span><span class="p">()[</span><span class="s1">&#39;train_score&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mean Validation score:&#39;</span><span class="p">,</span> <span class="n">cv_scores_df</span><span class="o">.</span><span class="n">mean</span><span class="p">()[</span><span class="s1">&#39;test_score&#39;</span><span class="p">])</span>

<span class="c1"># 5. Train your pipeline on the training set</span>
<span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># 6. Score the pipeline  on the test set</span>
<span class="n">tweet_test_score</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Test score:&#39;</span><span class="p">,</span> <span class="n">tweet_test_score</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mean training score: 0.9821853538313572
Mean Validation score: 0.8326422696721526
Test score: 0.83451536643026
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="lecture-6">
<h1>Lecture 6<a class="headerlink" href="#lecture-6" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id15">
<h2>Let’s Practice<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h2>
<p>Using Naive bayes by hand, what class would naive Bayes predict for the second example “I like Sauder”.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="s2">&quot;URGENT!! As a valued network customer you have been selected to receive a £900 prize reward!&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Lol you are always so convincing.&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Sauder has interesting courses.&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;URGENT! You have won a 1 week FREE membership in our £100000 prize Jackpot!&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Had your mobile 11 months or more? U R entitled to Update to the latest colour mobiles with camera for Free!&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Sauder has been interesting so far.&quot;</span> <span class="p">],</span>
                   <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;spam&quot;</span><span class="p">,</span> <span class="s2">&quot;non spam&quot;</span><span class="p">,</span> <span class="s2">&quot;non spam&quot;</span><span class="p">,</span> <span class="s2">&quot;spam&quot;</span><span class="p">,</span> <span class="s2">&quot;spam&quot;</span><span class="p">,</span> <span class="s2">&quot;non spam&quot;</span><span class="p">]})</span>
<span class="n">df</span>

<span class="n">count_vect</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">(</span><span class="n">max_features</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">stop_words</span><span class="o">=</span><span class="s1">&#39;english&#39;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">count_vect</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">])</span>
<span class="n">train_bow_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">toarray</span><span class="p">(),</span> <span class="n">columns</span><span class="o">=</span><span class="nb">sorted</span><span class="p">(</span><span class="n">count_vect</span><span class="o">.</span><span class="n">vocabulary_</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">])</span>

<span class="n">train_bow_df</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">train_bow_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>free</th>
      <th>prize</th>
      <th>sauder</th>
      <th>urgent</th>
      <th>target</th>
    </tr>
    <tr>
      <th>X</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>URGENT!! As a valued network customer you have been selected to receive a £900 prize reward!</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>spam</td>
    </tr>
    <tr>
      <th>Lol you are always so convincing.</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>non spam</td>
    </tr>
    <tr>
      <th>Sauder has interesting courses.</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>non spam</td>
    </tr>
    <tr>
      <th>URGENT! You have won a 1 week FREE membership in our £100000 prize Jackpot!</th>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>spam</td>
    </tr>
    <tr>
      <th>Had your mobile 11 months or more? U R entitled to Update to the latest colour mobiles with camera for Free!</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>spam</td>
    </tr>
    <tr>
      <th>Sauder has been interesting so far.</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>non spam</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_bow_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">1</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>urgent</th>
      <th>prize</th>
      <th>sauder</th>
      <th>free</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>I like Sauder</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Let’s do some of the steps here:</p>
<div class="section" id="spam">
<h3>spam<a class="headerlink" href="#spam" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p>Prior probability:
<span class="math notranslate nohighlight">\(P(\text{spam}) = 3/6\)</span></p></li>
<li><p>Conditional probabilities:</p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(P(\text{free} = 0 \mid \text{spam}) = 1/3\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(P(\text{prize} = 0 \mid \text{spam}) = 1/3\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(P(\text{sauder} = 1 \mid \text{spam}) = 0/3\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(P(\text{urgent} = 0 \mid \text{spam}) = 1/3\)</span></p></li>
</ol>
</li>
<li><p><span class="math notranslate nohighlight">\(P(\textrm{spam}|\text{free} = 0, \text{prize} = 0, \text{sauder} = 1,  \text{urgent} = 0) = P(\text{free} = 0|\textrm{spam})*P(\text{prize} = 0|\textrm{spam})*P(\textrm{sauder = 1}|\textrm{spam})*P(\text{urgent} = 0|\textrm{spam})*P(\textrm{spam})\)</span></p></li>
</ol>
<p><span class="math notranslate nohighlight">\(=  \frac{1}{3} * \frac{1}{3}* \frac{0}{3} * \frac{1}{3} *\frac{3}{6} \)</span></p>
<p><span class="math notranslate nohighlight">\( = 0\)</span></p>
</div>
<div class="section" id="non-spam">
<h3>non spam<a class="headerlink" href="#non-spam" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p>Prior probability:
<span class="math notranslate nohighlight">\(P(\text{non spam}) = 3/6\)</span></p></li>
<li><p>Conditional probabilities:</p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(P(\text{free} = 0 \mid \text{non spam}) = 3/3\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(P(\text{prize} = 0 \mid \text{non spam}) = 3/3\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(P(\text{sauder} = 1 \mid \text{non spam}) = 2/3\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(P(\text{urgent} = 0 \mid \text{non spam}) = 3/3\)</span></p></li>
</ol>
</li>
<li><p><span class="math notranslate nohighlight">\(P(\textrm{non spam}|\text{free} = 0, \text{prize} = 0, \text{sauder} = 1,  \text{urgent} = 0) = P(\text{free} = 0|\textrm{non spam})*P(\text{prize} = 0|\textrm{non spam})*P(\textrm{sauder = 1}|\textrm{non spam})*P(\text{urgent} = 0|\textrm{non spam})*P(\textrm{non spam})\)</span></p></li>
</ol>
<p><span class="math notranslate nohighlight">\(=  \frac{3}{3} * \frac{3}{3}* \frac{2}{3} * \frac{3}{3} *\frac{3}{6} \)</span></p>
<p><span class="math notranslate nohighlight">\( = 1/3\)</span></p>
</div>
<div class="section" id="final-class">
<h3>Final Class<a class="headerlink" href="#final-class" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p>CLASS AS: non spam</p></li>
</ol>
</div>
</div>
<div class="section" id="id16">
<h2>Let’s Practice<a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>Which method will attempt to find the optimal hyperparameter for the data by searching every combination possible of hyperparameter values given?</p></li>
</ol>
<blockquote>
<div><p>Exhaustive Grid Search (<code class="docutils literal notranslate"><span class="pre">GridSearchCV</span></code>)</p>
</div></blockquote>
<ol class="simple">
<li><p>Which method gives you fine-grained control over the amount of time spent searching?</p></li>
</ol>
<blockquote>
<div><p>Randomized Grid Search (<code class="docutils literal notranslate"><span class="pre">RandomizedSearchCV</span></code>)</p>
</div></blockquote>
<ol class="simple">
<li><p>If I want to search for the most optimal hyperparameter values among 3 different hyperparameters each with 3 different values how many trials of cross-validation would be needed?</p></li>
</ol>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(3 * 3 * 3 = 27\)</span></p>
</div></blockquote>
<p><strong>True or False</strong></p>
<ol class="simple">
<li><p>A Larger <code class="docutils literal notranslate"><span class="pre">n_iter</span></code> will take longer but will search over more hyperparameter values.</p></li>
</ol>
<blockquote>
<div><p>True</p>
</div></blockquote>
<ol class="simple">
<li><p>Automated hyperparameter optimization can only be used for multiple hyperparameters.</p></li>
</ol>
<blockquote>
<div><p>False</p>
</div></blockquote>
<div class="section" id="id17">
<h3>Coding Practice<a class="headerlink" href="#id17" title="Permalink to this headline">¶</a></h3>
<p>We are going to practice grid search using our basketball dataset that we have seen before.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Loading in the data</span>
<span class="n">bball_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/bball.csv&#39;</span><span class="p">)</span>
<span class="n">bball_df</span> <span class="o">=</span> <span class="n">bball_df</span><span class="p">[(</span><span class="n">bball_df</span><span class="p">[</span><span class="s1">&#39;position&#39;</span><span class="p">]</span> <span class="o">==</span><span class="s1">&#39;G&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">bball_df</span><span class="p">[</span><span class="s1">&#39;position&#39;</span><span class="p">]</span> <span class="o">==</span><span class="s1">&#39;F&#39;</span><span class="p">)]</span>

<span class="c1"># Define X and y</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">bball_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">,</span> <span class="s1">&#39;salary&#39;</span><span class="p">]]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">bball_df</span><span class="p">[</span><span class="s1">&#39;position&#39;</span><span class="p">]</span>

<span class="c1"># Split the dataset</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>

<span class="n">bb_pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
            <span class="n">steps</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;imputer&quot;</span><span class="p">,</span> <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;median&quot;</span><span class="p">)),</span>
                   <span class="p">(</span><span class="s2">&quot;scaler&quot;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span>
                   <span class="p">(</span><span class="s2">&quot;knn&quot;</span><span class="p">,</span> <span class="n">KNeighborsClassifier</span><span class="p">())])</span>
</pre></div>
</div>
</div>
</div>
<ol class="simple">
<li><p>Using the pipeline <code class="docutils literal notranslate"><span class="pre">bb_pipe</span></code> provided, create a grid of parameters to search over <code class="docutils literal notranslate"><span class="pre">param_grid</span></code>. Search over the values 1, 5, 10, 20, 30, 40, and 50 for the hyperparameter <code class="docutils literal notranslate"><span class="pre">n_neighbors</span></code> and ‘uniform’ and ‘distance’ for the hyperparameter <code class="docutils literal notranslate"><span class="pre">weights</span></code> (make sure to call them appropriately).</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">GridSearchCV</span></code> to hyperparameter tune using cross-validate equal to 10 folds. Make sure to specify the arguments <code class="docutils literal notranslate"><span class="pre">verbose=2</span></code> and <code class="docutils literal notranslate"><span class="pre">n_jobs=-1</span></code>.</p></li>
<li><p>Train your  pipeline with grid search.</p></li>
<li><p>Find the best hyperparameter values. Make sure to print these results.</p></li>
<li><p>Lastly, score your model on the test set.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. Build a grid of the parameters you wish to search. </span>
<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;knn__n_neighbors&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
    <span class="s2">&quot;knn__weights&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;uniform&#39;</span><span class="p">,</span> <span class="s1">&#39;distance&#39;</span><span class="p">]</span>
<span class="p">}</span>

<span class="c1"># 2. Conduct grid search with 10 fold cross-validation</span>
<span class="n">grid_search</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">bb_pipe</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># 3. Train your  pipeline with grid search. </span>
<span class="n">grid_search</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># 4. Find the best hyperparameter values.</span>
<span class="n">best_hyperparams</span> <span class="o">=</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">best_params_</span>
<span class="nb">print</span><span class="p">(</span><span class="n">best_hyperparams</span><span class="p">)</span>

<span class="c1"># 5. Lastly, score your model on the test set.</span>
<span class="n">bb_test_score</span> <span class="o">=</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
<span class="n">bb_test_score</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fitting 10 folds for each of 14 candidates, totalling 140 fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[Parallel(n_jobs=-1)]: Using backend LokyBackend with 8 concurrent workers.
[Parallel(n_jobs=-1)]: Done  25 tasks      | elapsed:    2.0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;knn__n_neighbors&#39;: 40, &#39;knn__weights&#39;: &#39;uniform&#39;}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[Parallel(n_jobs=-1)]: Done 140 out of 140 | elapsed:    2.2s finished
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9193548387096774
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="lecture-7">
<h1>Lecture 7<a class="headerlink" href="#lecture-7" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id18">
<h2>Let’s Practice<a class="headerlink" href="#id18" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>What is the name of a well-known <code class="docutils literal notranslate"><span class="pre">Ridge</span></code> hyperparameter?</p></li>
</ol>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">alpha</span></code></p>
</div></blockquote>
<ol class="simple">
<li><p>What value of this hyperparameter makes it equivalent to using <code class="docutils literal notranslate"><span class="pre">LinearRegression</span></code>?</p></li>
</ol>
<blockquote>
<div><p>0</p>
</div></blockquote>
<p>Use the following equation to answer the questions below:</p>
<div class="math notranslate nohighlight">
\[ \text{predicted(backpack_weight)} =  3.02 * \text{#laptops} + 0.3 * \text{#pencils} + 0.5 \]</div>
<ol class="simple">
<li><p>What is our intercept value?</p></li>
</ol>
<blockquote>
<div><p>0.5</p>
</div></blockquote>
<ol class="simple">
<li><p>If I had 2 laptops 3 pencils in my backpack, what weight would my model predict for my backpack?</p></li>
</ol>
<blockquote>
<div><p>7.44</p>
</div></blockquote>
<p><strong>True or False:</strong><br />
5. Ridge is a regression modelling approach.</p>
<blockquote>
<div><p>True</p>
</div></blockquote>
<ol class="simple">
<li><p>Increasing the hyperparameter from Question 1 increases model complexity.</p></li>
</ol>
<blockquote>
<div><p>False</p>
</div></blockquote>
<ol class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Ridge</span></code> can be used with datasets that have multiple features.</p></li>
</ol>
<blockquote>
<div><p>True</p>
</div></blockquote>
<ol class="simple">
<li><p>With <code class="docutils literal notranslate"><span class="pre">Ridge</span></code>, we learn one coefficient per training example.</p></li>
</ol>
<blockquote>
<div><p>False</p>
</div></blockquote>
<ol class="simple">
<li><p>Coefficients can help us interpret our model even if unscaled.</p></li>
</ol>
<blockquote>
<div><p>True</p>
</div></blockquote>
</div>
<div class="section" id="id19">
<h2>Let’s Practice<a class="headerlink" href="#id19" title="Permalink to this headline">¶</a></h2>
<p>We have the following text, which we wish to classify as either a positive or negative movie review.<br />
Using the words below (which are features in our model) with associated coefficients, answer the next 2 questions.<br />
The input for the feature value is the number of times the word appears in the review.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Word</p></th>
<th class="head"><p>Coefficient</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>excellent</p></td>
<td><p>2.2</p></td>
</tr>
<tr class="row-odd"><td><p>disappointment</p></td>
<td><p>-2.4</p></td>
</tr>
<tr class="row-even"><td><p>flawless</p></td>
<td><p>1.4</p></td>
</tr>
<tr class="row-odd"><td><p>boring</p></td>
<td><p>-1.3</p></td>
</tr>
<tr class="row-even"><td><p>unwatchable</p></td>
<td><p>-1.7</p></td>
</tr>
</tbody>
</table>
<p>Intercept = 1.3</p>
<ol class="simple">
<li><p>What value do you calculate after using the weights in the model above for the above review?</p></li>
</ol>
<p><em><strong>I thought it was going to be excellent but instead, it was unwatchable and boring.</strong></em></p>
<p>The input feature value would be the number of times the word appears in the review (like <code class="docutils literal notranslate"><span class="pre">CountVectorizer</span></code>).</p>
<blockquote>
<div><p>0.5</p>
</div></blockquote>
<ol class="simple">
<li><p>Would the model classify this review as a positive or negative review (classes are specified alphabetically) ?</p></li>
</ol>
<blockquote>
<div><p>Positive review</p>
</div></blockquote>
<p>We are trying to predict if a job applicant would be hired based on some features contained in their resume.</p>
<p>Below we have the output of <code class="docutils literal notranslate"><span class="pre">.predict_proba()</span></code> where column 0 shows the probability the model would predict “hired” and column 1 shows the probability the model would predict “not hired”.</p>
<div class="highlight-out notranslate"><div class="highlight"><pre><span></span>array([[0.04971843, 0.95028157],
       [0.94173513, 0.05826487],
       [0.74133975, 0.25866025],
       [0.13024982, 0.86975018],
       [0.17126403, 0.82873597]])
</pre></div>
</div>
<p>Use this output to answer the following questions.</p>
<ol class="simple">
<li><p>If we had used <code class="docutils literal notranslate"><span class="pre">.predict()</span></code> for these examples instead of <code class="docutils literal notranslate"><span class="pre">.predict_proba()</span></code>, how many of the examples would the model have predicted “hired”?</p></li>
</ol>
<blockquote>
<div><p>2</p>
</div></blockquote>
<ol class="simple">
<li><p>If the true class labels are below, how many examples would the model have correctly predicted with <code class="docutils literal notranslate"><span class="pre">predict()</span></code>?</p></li>
</ol>
<div class="highlight-out notranslate"><div class="highlight"><pre><span></span>[&#39;hired&#39;, &#39;hired&#39;, &#39;hired&#39;, &#39;not hired&#39;, &#39;not hired&#39;]
</pre></div>
</div>
<blockquote>
<div><p>4</p>
</div></blockquote>
<p><strong>True or False?</strong><br />
5. Increasing logistic regression’s <code class="docutils literal notranslate"><span class="pre">C</span></code> hyperparameter increases the model’s complexity.</p>
<blockquote>
<div><p>True</p>
</div></blockquote>
<ol class="simple">
<li><p>Unlike with <code class="docutils literal notranslate"><span class="pre">Ridge</span></code> regression, coefficients are not interpretable with logistic regression.</p></li>
</ol>
<blockquote>
<div><p>. False</p>
</div></blockquote>
<ol class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">predict</span></code> returns the positive class if the predicted probability of the positive class is greater than 0.5.</p></li>
</ol>
<blockquote>
<div><p>True</p>
</div></blockquote>
<ol class="simple">
<li><p>In logistic regression, a function is applied to convert the raw model output into probabilities.</p></li>
</ol>
<blockquote>
<div><p>True</p>
</div></blockquote>
<p><strong>Coding Problem</strong></p>
<p>Let’s import the Pokémon dataset from our <code class="docutils literal notranslate"><span class="pre">data</span></code> folder. We want to see how well our model does with logistic regression. Let’s try building a simple model with default parameters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pk_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/pokemon.csv&#39;</span><span class="p">)</span>

<span class="n">train_df</span><span class="p">,</span> <span class="n">test_df</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">pk_df</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">X_train</span> <span class="o">=</span> <span class="n">train_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;legendary&#39;</span><span class="p">])</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">train_df</span><span class="p">[</span><span class="s1">&#39;legendary&#39;</span><span class="p">]</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">test_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;legendary&#39;</span><span class="p">])</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">test_df</span><span class="p">[</span><span class="s1">&#39;legendary&#39;</span><span class="p">]</span>


<span class="n">numeric_features</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;attack&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;defense&quot;</span> <span class="p">,</span>
                    <span class="s2">&quot;sp_attack&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;sp_defense&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;speed&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;capture_rt&quot;</span><span class="p">]</span>

<span class="n">drop_features</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;deck_no&quot;</span><span class="p">,</span> <span class="s2">&quot;gen&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;total_bs&quot;</span><span class="p">]</span>

<span class="n">numeric_transformer</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span>
    <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;median&quot;</span><span class="p">),</span>
    <span class="n">StandardScaler</span><span class="p">())</span>

<span class="n">preprocessor</span> <span class="o">=</span> <span class="n">make_column_transformer</span><span class="p">(</span>
    <span class="p">(</span><span class="s2">&quot;drop&quot;</span><span class="p">,</span> <span class="n">drop_features</span><span class="p">),</span>
    <span class="p">(</span><span class="n">numeric_transformer</span><span class="p">,</span> <span class="n">numeric_features</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<ol class="simple">
<li><p>Build and fit a pipeline containing the column transformer and a logistic regression model using the parameter class_weight=”balanced” (you will learn about this in lecture 9!).</p></li>
<li><p>Score your model on the test set.</p></li>
<li><p>Find the model’s feature coefficients and answer the below questions
a. Which feature contributes the most in predicting if an example is legendary or not.
b.As the capture rate value increases, will the model more likely predict a legendary or not legendary Pokémon?</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. Build a pipeline containing the column transformer and a Logistic Regression model</span>
<span class="c1"># use the parameter class_weight=&quot;balanced&quot;</span>
<span class="n">pkm_pipe</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span><span class="n">preprocessor</span><span class="p">,</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">class_weight</span><span class="o">=</span><span class="s2">&quot;balanced&quot;</span><span class="p">))</span>

<span class="c1"># 1. Fit your pipeline on the training data</span>
<span class="n">pkm_pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">);</span>

<span class="c1"># 2. Score your model on the test set </span>
<span class="n">lr_scores</span> <span class="o">=</span> <span class="n">pkm_pipe</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;logistic Regression Test Score:&quot;</span><span class="p">,</span> <span class="n">lr_scores</span><span class="p">)</span>

<span class="c1"># Find the model’s feature coefficients</span>
<span class="n">pkm_coefs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;features&#39;</span><span class="p">:</span><span class="n">numeric_features</span><span class="p">,</span> <span class="s1">&#39;coefficients&#39;</span><span class="p">:</span><span class="n">pkm_pipe</span><span class="p">[</span><span class="s1">&#39;logisticregression&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">]})</span>
<span class="n">pkm_coefs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>logistic Regression Test Score: 0.9006211180124224
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>features</th>
      <th>coefficients</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>attack</td>
      <td>0.690834</td>
    </tr>
    <tr>
      <th>1</th>
      <td>defense</td>
      <td>1.126300</td>
    </tr>
    <tr>
      <th>2</th>
      <td>sp_attack</td>
      <td>1.026617</td>
    </tr>
    <tr>
      <th>3</th>
      <td>sp_defense</td>
      <td>0.655162</td>
    </tr>
    <tr>
      <th>4</th>
      <td>speed</td>
      <td>1.116679</td>
    </tr>
    <tr>
      <th>5</th>
      <td>capture_rt</td>
      <td>-0.792950</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>a. Which feature contributes the most in predicting if an example is legendary or not.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">defense</span></code>, this feature has the highest magnitude!</p>
</div></blockquote>
<p>b.As the capture rate value increases, will the model more likely predict a legendary or not legendary Pokémon?</p>
<blockquote>
<div><p>Not Legendary, since the sign of the coefficient is negative.</p>
</div></blockquote>
</div>
<div class="section" id="lecture-8">
<h2>Lecture 8<a class="headerlink" href="#lecture-8" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="id20">
<h2>Let’s Practice<a class="headerlink" href="#id20" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>What question is usually more complex?</p></li>
</ol>
<blockquote>
<div><p>Business question/objective</p>
</div></blockquote>
<ol class="simple">
<li><p>What model needs to be made for all problems?</p></li>
</ol>
<blockquote>
<div><p>Baseline - Dummy</p>
</div></blockquote>
<ol class="simple">
<li><p>In supervised learning, once we have our business objective, part of our statistical question is identifying what?</p></li>
</ol>
<blockquote>
<div><p>Our target variable</p>
</div></blockquote>
<p><strong>True or False:</strong></p>
<ol class="simple">
<li><p>When writing your reports, it’s important to consider who is reading it.</p></li>
</ol>
<blockquote>
<div><p>True</p>
</div></blockquote>
<ol class="simple">
<li><p>Sometimes you may need to dig a little to figure out exactly what the client wants.</p></li>
</ol>
<blockquote>
<div><p>True</p>
</div></blockquote>
<ol class="simple">
<li><p>In supervised learning, we should take into consideration the uncertainty of our models.</p></li>
</ol>
<blockquote>
<div><p>True</p>
</div></blockquote>
</div>
<div class="section" id="id21">
<h2>Let’s Practice<a class="headerlink" href="#id21" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>As we increase features, which score will always increase?</p></li>
</ol>
<blockquote>
<div><p>Training score</p>
</div></blockquote>
<ol class="simple">
<li><p>Between <code class="docutils literal notranslate"><span class="pre">RFE</span></code> and <code class="docutils literal notranslate"><span class="pre">RFECV</span></code> which one finds the optimal number of features for us?</p></li>
</ol>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">RFECV</span></code></p>
</div></blockquote>
<ol class="simple">
<li><p>Which method starts with all our features and iteratively removes them from our model?</p></li>
</ol>
<blockquote>
<div><p>Recursive Feature Elimination</p>
</div></blockquote>
<ol class="simple">
<li><p>Which method starts with no features and iteratively adds features?</p></li>
</ol>
<blockquote>
<div><p>Forward Selection</p>
</div></blockquote>
<ol class="simple">
<li><p>Which method does not take into consideration <code class="docutils literal notranslate"><span class="pre">feature_importance</span></code> when adding/removing features?</p></li>
</ol>
<blockquote>
<div><p>Forward Selection</p>
</div></blockquote>
</div>
<div class="section" id="lecture-9">
<h2>Lecture 9<a class="headerlink" href="#lecture-9" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="id22">
<h2>Let’s Practice<a class="headerlink" href="#id22" title="Permalink to this headline">¶</a></h2>
<a class="reference internal image-reference" href="../_images/Q_cm.png"><img alt="404 image" src="../_images/Q_cm.png" style="width: 50%;" /></a>
<p>Use the diagram above to answer the next …. questions.</p>
<ol class="simple">
<li><p>How many examples did the model of this matrix correctly label as “Guard”?</p></li>
</ol>
<blockquote>
<div><p>26</p>
</div></blockquote>
<ol class="simple">
<li><p>If <strong>Forward</strong> is the positive label, how many <em><strong>false-positive</strong></em> values are there?</p></li>
</ol>
<blockquote>
<div><p>4</p>
</div></blockquote>
<ol class="simple">
<li><p>How many examples does the model incorrectly predict?</p></li>
</ol>
<blockquote>
<div><p>7</p>
</div></blockquote>
<ol class="simple">
<li><p>What is the recall of the confusion matrix assuming that <strong>Forward</strong> is the positive label?</p></li>
</ol>
<blockquote>
<div><p>0.86<br />
19/22</p>
</div></blockquote>
<ol class="simple">
<li><p>What is the precision of the confusion matrix assuming that <strong>Forward</strong> is the positive label?</p></li>
</ol>
<blockquote>
<div><p>0.83
19/23</p>
</div></blockquote>
<ol class="simple">
<li><p>What is the f1 score assuming that <strong>Forward</strong> is the positive label?</p></li>
</ol>
<blockquote>
<div><p>0.84
2* (0.86*0.83)/ (0.86 + 0.83) = 0.84</p>
</div></blockquote>
<p><strong>True or False:</strong></p>
<ol class="simple">
<li><p>In spam classification, false positives are more damaging than false negatives (assume “positive” means the email is spam, “negative” means it’s not).</p></li>
</ol>
<blockquote>
<div><p>True</p>
</div></blockquote>
<ol class="simple">
<li><p>In medical diagnosis, high recall is more important than high precision.</p></li>
</ol>
<blockquote>
<div><p>True</p>
</div></blockquote>
<ol class="simple">
<li><p>The weighted average gives equal importance to all classes.</p></li>
</ol>
<blockquote>
<div><p>False</p>
</div></blockquote>
<ol class="simple">
<li><p>Setting <code class="docutils literal notranslate"><span class="pre">class_weight={1:100}</span></code> will make the second class label 100 times the weight of the first class.</p></li>
</ol>
<blockquote>
<div><p>False</p>
</div></blockquote>
</div>
<div class="section" id="id23">
<h2>Let’s Practice<a class="headerlink" href="#id23" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>Which measurement will have units which are the square values of the target column units?</p></li>
</ol>
<blockquote>
<div><p>MSE</p>
</div></blockquote>
<ol class="simple">
<li><p>For which of the following is it possible to have negative values?</p></li>
</ol>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(R^2\)</span></p>
</div></blockquote>
<ol class="simple">
<li><p>Which measurement is expressed as a percentage?</p></li>
</ol>
<blockquote>
<div><p>MAPE</p>
</div></blockquote>
<ol class="simple">
<li><p>Calculate the MSE from the values given below.</p></li>
</ol>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Observation</p></th>
<th class="head"><p>True Value</p></th>
<th class="head"><p>Predicted Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>4</p></td>
<td><p>5</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>12</p></td>
<td><p>10</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>6</p></td>
<td><p>9</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>9</p></td>
<td><p>8</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>3</p></td>
<td><p>3</p></td>
</tr>
</tbody>
</table>
<blockquote>
<div><p>3</p>
</div></blockquote>
<p><strong>True or False:</strong></p>
<ol class="simple">
<li><p>We can still use recall and precision for regression problems but now we have other measurements we can use as well.</p></li>
</ol>
<blockquote>
<div><p>False</p>
</div></blockquote>
<ol class="simple">
<li><p>A lower RMSE value indicates a better fit.</p></li>
</ol>
<blockquote>
<div><p>True</p>
</div></blockquote>
<ol class="simple">
<li><p>In regression problems, calculating <span class="math notranslate nohighlight">\(R^2\)</span>  using <code class="docutils literal notranslate"><span class="pre">r2_score()</span></code> and <code class="docutils literal notranslate"><span class="pre">.score()</span></code> (with default values) will produce the same results.</p></li>
</ol>
<blockquote>
<div><p>True</p>
</div></blockquote>
</div>
<div class="section" id="id24">
<h2>Let’s Practice<a class="headerlink" href="#id24" title="Permalink to this headline">¶</a></h2>
<p><strong>True or False:</strong></p>
<ol class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">scoring</span></code> argument only accepts <code class="docutils literal notranslate"><span class="pre">str</span></code> inputs.</p></li>
</ol>
<blockquote>
<div><p>False</p>
</div></blockquote>
<ol class="simple">
<li><p>We are limited to the scoring measures offered from sklearn.</p></li>
</ol>
<blockquote>
<div><p>False</p>
</div></blockquote>
<ol class="simple">
<li><p>If we specify the scoring method in <code class="docutils literal notranslate"><span class="pre">GridSearchCV</span></code> and <code class="docutils literal notranslate"><span class="pre">RandomizedSearchCV</span></code>, <code class="docutils literal notranslate"><span class="pre">best_param_</span></code>  will return the parameters with the highest specified measure.*</p></li>
</ol>
<blockquote>
<div><p>True</p>
</div></blockquote>
<p><strong>Coding Question</strong></p>
<p>Let’s bring back the Pokémon dataset that we saw previously.</p>
<p>This time let’s look at the distribution of our target variable <code class="docutils literal notranslate"><span class="pre">legendary</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>


<span class="n">pk_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/pokemon.csv&#39;</span><span class="p">)</span>

<span class="n">train_df</span><span class="p">,</span> <span class="n">test_df</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">pk_df</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">X_train_big</span> <span class="o">=</span> <span class="n">train_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;legendary&#39;</span><span class="p">])</span>
<span class="n">y_train_big</span> <span class="o">=</span> <span class="n">train_df</span><span class="p">[</span><span class="s1">&#39;legendary&#39;</span><span class="p">]</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">test_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;legendary&#39;</span><span class="p">])</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">test_df</span><span class="p">[</span><span class="s1">&#39;legendary&#39;</span><span class="p">]</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_valid</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_valid</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_train_big</span><span class="p">,</span> 
                                                      <span class="n">y_train_big</span><span class="p">,</span> 
                                                      <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> 
                                                      <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">y_train</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    405
1     43
Name: legendary, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Let’s do cross-validation and look at the scores from cross-validation of not just accuracy, but precision and recall and the f1 score as well.</p>
<ol class="simple">
<li><p>Build a pipeline containing the column transformer and an SVC model and set <code class="docutils literal notranslate"><span class="pre">class_weight=&quot;balanced&quot;</span></code> in the SVM classifier.</p></li>
<li><p>Perform cross-validation using cross-validate on the training split using the scoring measures accuracy, precision, recall and f1.</p></li>
<li><p>Save the results in a dataframe.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pk_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/pokemon.csv&#39;</span><span class="p">)</span>

<span class="n">train_df</span><span class="p">,</span> <span class="n">test_df</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">pk_df</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">X_train</span> <span class="o">=</span> <span class="n">train_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;legendary&#39;</span><span class="p">])</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">train_df</span><span class="p">[</span><span class="s1">&#39;legendary&#39;</span><span class="p">]</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">test_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;legendary&#39;</span><span class="p">])</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">test_df</span><span class="p">[</span><span class="s1">&#39;legendary&#39;</span><span class="p">]</span>

<span class="n">numeric_features</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;deck_no&quot;</span><span class="p">,</span>  
                    <span class="s2">&quot;attack&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;defense&quot;</span> <span class="p">,</span>
                    <span class="s2">&quot;sp_attack&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;sp_defense&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;speed&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;capture_rt&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;total_bs&quot;</span><span class="p">]</span>

<span class="n">categorical_features</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span>

<span class="n">numeric_transformer</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span><span class="n">SimpleImputer</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;median&quot;</span><span class="p">),</span> <span class="n">StandardScaler</span><span class="p">())</span>

<span class="n">categorical_transformer</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span>
    <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;most_frequent&quot;</span><span class="p">),</span>
    <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">handle_unknown</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">))</span>

<span class="n">preprocessor</span> <span class="o">=</span> <span class="n">make_column_transformer</span><span class="p">(</span>
    <span class="p">(</span><span class="n">numeric_transformer</span><span class="p">,</span> <span class="n">numeric_features</span><span class="p">),</span> 
    <span class="p">(</span><span class="n">categorical_transformer</span><span class="p">,</span> <span class="n">categorical_features</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. Build a pipeline containing the column transformer and an SVC model, </span>
<span class="c1"># using the parameter class_weight=&quot;balanced&quot;.</span>
<span class="n">main_pipe</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span><span class="n">preprocessor</span><span class="p">,</span> <span class="n">SVC</span><span class="p">(</span><span class="n">class_weight</span><span class="o">=</span><span class="s2">&quot;balanced&quot;</span><span class="p">))</span>

<span class="c1"># 2. Perform cross-validation using cross-validate on the training split using the scoring</span>
<span class="c1"># measures accuracy, precision, recall and f1.</span>
<span class="n">multi_scores</span> <span class="o">=</span> <span class="n">cross_validate</span><span class="p">(</span><span class="n">main_pipe</span><span class="p">,</span>
                              <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span>
                              <span class="n">return_train_score</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                              <span class="n">scoring</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="s1">&#39;precision&#39;</span><span class="p">,</span> <span class="s1">&#39;recall&#39;</span><span class="p">])</span>

<span class="c1"># 3. Save the results in a dataframe.</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">multi_scores</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fit_time</th>
      <th>score_time</th>
      <th>test_accuracy</th>
      <th>train_accuracy</th>
      <th>test_precision</th>
      <th>train_precision</th>
      <th>test_recall</th>
      <th>train_recall</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.017855</td>
      <td>0.011000</td>
      <td>0.921875</td>
      <td>0.972656</td>
      <td>0.500000</td>
      <td>0.754386</td>
      <td>0.600000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.014644</td>
      <td>0.009241</td>
      <td>0.984375</td>
      <td>0.976562</td>
      <td>0.833333</td>
      <td>0.781818</td>
      <td>1.000000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.014496</td>
      <td>0.008741</td>
      <td>0.921875</td>
      <td>0.984375</td>
      <td>0.545455</td>
      <td>0.840000</td>
      <td>0.545455</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.020357</td>
      <td>0.014639</td>
      <td>0.953125</td>
      <td>0.980469</td>
      <td>0.647059</td>
      <td>0.807692</td>
      <td>1.000000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.013667</td>
      <td>0.008995</td>
      <td>0.968750</td>
      <td>0.970703</td>
      <td>0.733333</td>
      <td>0.736842</td>
      <td>1.000000</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="lecture-10">
<h2>Lecture 10<a class="headerlink" href="#lecture-10" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="id25">
<h2>Let’s Practice<a class="headerlink" href="#id25" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>Which wrapper is more computationally expensive?</p></li>
</ol>
<blockquote>
<div><p>One-vs-One</p>
</div></blockquote>
<ol class="simple">
<li><p>Name a model that can handle multi-class problems without any issues or needing any additional strategies.</p></li>
</ol>
<blockquote>
<div><p>Decision Trees, K-nn</p>
</div></blockquote>
<ol class="simple">
<li><p>If I have 6 classes, how many models will be built if I use the One-vs-Rest strategy?</p></li>
</ol>
<blockquote>
<div><p>6</p>
</div></blockquote>
<ol class="simple">
<li><p>If I have 6 classes, how many models will be built if I use the One-vs-One strategy?</p></li>
</ol>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(6(5)/2 = 15\)</span></p>
</div></blockquote>
<p>Use the diagram below to answer the next few questions:</p>
<a class="reference internal image-reference" href="../_images/multi-classQ.png"><img alt="404 image" src="../_images/multi-classQ.png" style="width: 70%;" /></a>
<ol class="simple">
<li><p>How many examples did the model correctly predict?</p></li>
</ol>
<blockquote>
<div><p>52</p>
</div></blockquote>
<ol class="simple">
<li><p>How many examples were incorrectly labeled as <code class="docutils literal notranslate"><span class="pre">G</span></code>?</p></li>
</ol>
<blockquote>
<div><p>3</p>
</div></blockquote>
<ol class="simple">
<li><p>How many <code class="docutils literal notranslate"><span class="pre">F-C</span></code> labels were in the data?</p></li>
</ol>
<blockquote>
<div><p>6</p>
</div></blockquote>
<p><strong>True or False:</strong><br />
8. Decision Trees use coefficients for multi-class data.</p>
<blockquote>
<div><p>False</p>
</div></blockquote>
<ol class="simple">
<li><p>Using 1 target label as the positive class will make all other target labels negative.</p></li>
</ol>
<blockquote>
<div><p>True</p>
</div></blockquote>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "bait509-ubc/BAIT509",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./lectures"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Hayley Boyce<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>